diff -urN iptables-1.2.9rc1/extensions/Makefile iptables-1.2.9rc1-patched/extensions/Makefile
--- iptables-1.2.9rc1/extensions/Makefile	2003-10-07 11:59:26.000000000 -0700
+++ iptables-1.2.9rc1-patched/extensions/Makefile	2003-10-27 08:46:24.000000000 -0800
@@ -5,7 +5,7 @@
 # header files are present in the include/linux directory of this iptables
 # package (HW)
 #
-PF_EXT_SLIB:=ah connlimit conntrack dscp ecn esp helper icmp iprange length limit mac mark multiport owner physdev pkttype realm rpc standard state tcp tcpmss tos ttl udp unclean CLASSIFY CONNMARK DNAT DSCP ECN LOG MARK MASQUERADE MIRROR NETMAP NOTRACK REDIRECT REJECT SAME SNAT TARPIT TCPMSS TOS TRACE TTL ULOG
+PF_EXT_SLIB:=ah connlimit conntrack dscp ecn esp helper icmp iprange length limit mac mark multiport owner physdev pkttype realm rpc standard state tcp tcpmss tos ttl udp unclean CLASSIFY CONNMARK DNAT DSCP ECN LOG MARK MASQUERADE MIRROR NETMAP NOTRACK REDIRECT REJECT DIVERT SAME SNAT TARPIT TCPMSS TOS TRACE TTL ULOG
 PF6_EXT_SLIB:=eui64 hl icmpv6 length limit mac mark multiport owner standard tcp udp HL LOG MARK TRACE
 
 # Optionals
diff -urN iptables-1.2.9rc1/extensions/libipt_DIVERT.c iptables-1.2.9rc1-patched/extensions/libipt_DIVERT.c
--- iptables-1.2.9rc1/extensions/libipt_DIVERT.c	1969-12-31 16:00:00.000000000 -0800
+++ iptables-1.2.9rc1-patched/extensions/libipt_DIVERT.c	2003-10-27 08:45:55.000000000 -0800
@@ -0,0 +1,103 @@
+/* Shared library add-on to iptables to add TPROXY target support. */
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+#include <getopt.h>
+
+#include <iptables.h>
+#include <linux/netfilter_ipv4/ip_tables.h>
+#include <linux/netfilter_ipv4/ipt_DIVERT.h>
+
+struct tosinfo {
+    struct ipt_entry_target t;
+    struct ipt_divert_target_info divert;
+};
+
+static void help(void)
+{
+    printf("DIVERT target v%s options:\n"
+           "  --to-port port                   DIVERT packets to port\n",
+           IPTABLES_VERSION);
+}
+
+static struct option opts[] = {
+    { "to-port", 1, 0, '1' },
+    { 0 }
+};
+
+static void init(struct ipt_entry_target *t, unsigned int *nfcache)
+{}
+
+static void parse_divert(const unsigned char *s, struct ipt_divert_target_info *info)
+{
+    int divert_port;
+    string_to_number(s, 0, 65535, &divert_port);
+    info->to_port = htons(divert_port);
+}
+
+static int parse(int c, char **argv, int invert, unsigned int *flags,
+                 const struct ipt_entry *entry,
+                 struct ipt_entry_target **target)
+{
+    struct ipt_divert_target_info *divertinfo
+        = (struct ipt_divert_target_info *)(*target)->data;
+
+    switch (c) {
+    case '1':
+        if (*flags)
+            exit_error(PARAMETER_PROBLEM,"DIVERT target: Can't specify --to-port twice");
+        parse_divert(optarg, divertinfo);
+        *flags = 1;
+        break;
+
+    default:
+        return 0;
+    }
+
+    return 1;
+}
+
+static void final_check(unsigned int flags)
+{
+    if (!flags)
+        exit_error(PARAMETER_PROBLEM,
+                   "DIVERT target: Parameter --to-port is required");
+}
+
+static void print(const struct ipt_ip *ip,
+                  const struct ipt_entry_target *target,
+                  int numeric)
+{
+    const struct ipt_divert_target_info *divertinfo =
+        (const struct ipt_divert_target_info *)target->data;
+    printf("DIVERT redirect %d", ntohs(divertinfo->to_port));
+}
+
+static void save(const struct ipt_ip *ip, const struct ipt_entry_target *target)
+{
+    const struct ipt_divert_target_info *divertinfo =
+        (const struct ipt_divert_target_info *)target->data;
+
+    printf("--to-port %d ", ntohs(divertinfo->to_port));
+}
+
+static 
+struct iptables_target divert 
+= { NULL,
+    "DIVERT",
+    IPTABLES_VERSION,
+    IPT_ALIGN(sizeof(struct ipt_divert_target_info)),
+    IPT_ALIGN(sizeof(struct ipt_divert_target_info)),
+    &help,
+    &init,
+    &parse,
+    &final_check,
+    &print,
+    &save,
+    opts
+};
+
+void _init(void)
+{
+    register_target(&divert);
+}
