#! /bin/sh

DEFAULT_FILE="/etc/default/snmpd"

MONIT_CONF_FILE="/etc/untangle/monit.conf"

isEnabled() {
  grep -q "SNMPDRUN=yes" $DEFAULT_FILE
}

# guaranteed to do the right thing, per the setting above
/etc/init.d/snmpd restart

# tell monit what to do
if isEnabled ; then
  cp -f /usr/share/untangle/snmp/snmpd_all.conf /etc/untangle/monit.d/
else
  rm -f /etc/untangle/monit.d/snmpd_all.conf
fi

touch /etc/untangle/monit-to-restart
