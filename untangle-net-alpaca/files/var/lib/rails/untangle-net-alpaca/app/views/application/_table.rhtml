<% 
@first_row_css_class = "first" 
table_only = false if table_only.nil?
options = { :view => self }
%>

<% if table_model.has_label && !table_only %>
  <div align="right" class="table-label <%= table_model.css_class %>">
    <div class="table-title"><%= table_model.table_name.t %><!-- : <%= data.rows.length %> total --></div>
    <% if table_model.has_action %>
      <%= table_model.action( data, self ) %>
    <% else %>
      <div>&nbsp;</div>
    <% end %>
  </div>
<% end %>

<% unless table_only %>
<div class="list-table-container <%= table_model.css_class %>">
  <ul class="header">
    <li>
      <% first_css_class = "first" %>

      <% table_model.columns.each do |column| %>
        <div class="<%= "#{column.css_class} #{first_css_class}" %>"><span><%= column.generate_header( options ) %></span></div>
        <% first_css_class = "" %>
      <% end %>
    </li>
  </ul>
  <div id="<%= data.css_id + "-list-table"  %>" class="list-table">

<% end %>
    <ul id="<%= data.css_id %>" class="<%= table_model.css_class %>">
      <%= render( :partial => "application/table_row", :collection => data.rows, :locals => { :table_model => table_model, :data => data } ) %>
    </ul>

<% unless table_only %>
  </div>
</div>
<% end %>

<%= javascript_tag "
//Sortable.create('#{data.css_id}', {scroll:'#{data.css_id}-list-table');
TableManager.updateRowStyles( '#{data.css_id}' );" %>
