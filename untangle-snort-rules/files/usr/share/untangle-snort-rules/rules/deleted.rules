alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB DCERPC Workstation Service unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,&,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2308; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB DCERPC Workstation Service bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2309; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS DCERPC Workstation Service unicode bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,&,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|"; within:15; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2310; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS DCERPC Workstation Service bind attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00 0B|"; within:10; distance:4; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2311; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC Workstation Service direct service bind attempt"; flow:to_server,established; content:"|05 00 0B|"; depth:3; byte_test:1,&,16,1,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:29; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2315; rev:7;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC Workstation Service direct service access attempt"; content:"|04 00|"; depth:2; byte_test:1,&,16,2,relative; content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z"; within:16; distance:22; reference:bugtraq,9011; reference:cve,2003-0812; reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx; classtype:misc-attack; sid:2316; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"DELETED BACKDOOR mass connect 1.1 runtime detection - http"; flow:to_server,established; content:"User-Agent|3A|"; nocase; content:"UtilMind"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]*UtilMind\s+HTTPGet/smi"; threshold:type limit, track by_src, count 1, seconds 3000; reference:url,splintersecurity.com/DownloadDB/pafiledb.php?action=file&id=462; classtype:trojan-activity; sid:7100; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 617 (msg:"DELETED DOS arkiea backup"; flow:to_server,established; dsize:>1445; reference:arachnids,261; reference:bugtraq,662; reference:cve,1999-0788; classtype:attempted-dos; sid:282; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv3 invalid data version attempt"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; content:!"|03|"; depth:1; offset:9; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2500; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv3 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 00|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,sslv3.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2532; rev:7;)
alert tcp $HOME_NET 995 -> $EXTERNAL_NET any (msg:"DELETED POP3 SSLv3 Server_Hello request"; flow:to_client,established; flowbits:isset,sslv3.client_hello.request; content:"|16 03 00|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,sslv3.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2533; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv3 invalid Client_Hello attempt"; flow:to_server,established; flowbits:isset,sslv3.server_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2534; rev:7;)
alert tcp $HOME_NET 995 -> $EXTERNAL_NET any (msg:"DELETED POP3 SSLv2 Server_Hello request"; flow:from_server,established; flowbits:isset,sslv2.client_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3509; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv2 Client_Hello with pad request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,<,128,0; content:"|01|"; depth:1; offset:3; content:"|00 02|"; depth:2; offset:6; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3506; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv2 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3505; rev:2;)
alert tcp $HOME_NET 995 -> $EXTERNAL_NET any (msg:"DELETED POP3 TLSv1 Server_Hello request"; flow:to_client,established; flowbits:isset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,tlsv1.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3510; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 TLSv1 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3507; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 TLSv1 Client_Hello via SSLv2 handshake request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|03 01|"; depth:2; offset:3; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3508; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP Mozilla regular expression heap corruption attempt"; flow:established, to_server; content:"RegExp"; nocase; pcre:"/(\x22(\x5C.|[^\x5C\x22])*\x5B(\x5C.|[^\x5C\x22\x5D])*\x5C\x5C\x22|\x27(\x5C.|[^\x5C\x27])*\x5B(\x5C.|[^\x5C\x27\x5D])*\x5C\x5C\x27)/sm"; reference:bugtraq,20042; reference:cve,2006-4566; classtype:attempted-user; sid:8442; rev:2;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_enumresultset possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; offset:32; nocase; reference:bugtraq,2031; reference:cve,2000-1082; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:708; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_displayparamstmt possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t|00|"; offset:32; nocase; reference:bugtraq,2030; reference:cve,2000-1081; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:702; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_setsqlsecurity possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|e|00|t|00|s|00|q|00|l|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; offset:32; nocase; reference:bugtraq,2043; reference:cve,2000-1088; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:703; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_printstatements possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; offset:32; nocase; reference:bugtraq,2041; reference:cve,2000-1086; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:690; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_showcolv possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; offset:32; nocase; reference:bugtraq,2038; reference:cve,2000-1083; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:696; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_peekqueue possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; offset:32; nocase; reference:bugtraq,2040; reference:cve,2000-1085; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:697; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_proxiedmetadata possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; offset:32; nocase; reference:bugtraq,2042; reference:cve,2000-1087; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:698; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"DELETED MS-SQL/SMB xp_updatecolvbm possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; offset:32; nocase; reference:bugtraq,2039; reference:cve,2000-1084; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:700; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_displayparamstmt possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t"; nocase; reference:bugtraq,2030; reference:cve,2000-1081; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:674; rev:9;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_setsqlsecurity possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|e|00|t|00|s|00|q|00|l|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; nocase; reference:bugtraq,2043; reference:cve,2000-1088; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:675; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_enumresultset possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; nocase; reference:bugtraq,2031; reference:cve,2000-1082; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:682; rev:11;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_printstatements possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; nocase; reference:bugtraq,2041; reference:cve,2000-1086; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:699; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_updatecolvbm possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; nocase; reference:bugtraq,2039; reference:cve,2000-1084; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:701; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_showcolv possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; nocase; reference:bugtraq,2038; reference:cve,2000-1083; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:705; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_peekqueue possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; nocase; reference:bugtraq,2040; reference:cve,2000-1085; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:706; rev:10;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"DELETED MS-SQL xp_proxiedmetadata possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; nocase; reference:bugtraq,2024; reference:cve,1999-0287; reference:cve,2000-1087; reference:url,www.microsoft.com/technet/security/bulletin/MS00-092.mspx; classtype:attempted-user; sid:707; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"DELETED WEB-CLIENT Mozilla regular expression heap corruption attempt"; flow:established,to_client; content:"RegExp"; nocase; pcre:"/(\x22(\x5C.|[^\x5C\x22])*\x5B(\x5C.|[^\x5C\x22\x5D])*\x5C\x5C\x22|\x27(\x5C.|[^\x5C\x27])*\x5B(\x5C.|[^\x5C\x27\x5D])*\x5C\x5C\x27)/sm"; reference:bugtraq,20042; reference:cve,2006-4566; classtype:attempted-user; sid:8443; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC ///cgi-bin access"; flow:to_server,established; uricontent:"///cgi-bin"; nocase; rawbytes; reference:nessus,11032; classtype:attempted-recon; sid:1143; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC /cgi-bin/// access"; flow:to_server,established; uricontent:"/cgi-bin///"; nocase; rawbytes; reference:nessus,11032; classtype:attempted-recon; sid:1144; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP command overflow attempt"; flow:to_server,established,no_stream; dsize:>100; reference:bugtraq,4638; reference:cve,2002-0606; classtype:protocol-command-decode; sid:1748; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"DELETED WEB-CLIENT Open document file transfer attempt"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; flowbits:set,odf.file; flowbits:noalert; classtype:not-suspicious; sid:8447; rev:2;)
alert tcp $HOME_NET 23476 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR DonaldDick 1.53 Traffic"; flow:from_server,established; content:"pINg"; reference:mcafee,98575; classtype:misc-activity; sid:153; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3127:3198 (msg:"DELETED BACKDOOR mydoom.a backdoor upload/execute attempt"; flow:to_server,established; content:"|85 13|<|9E A2|"; depth:5; classtype:trojan-activity; sid:3272; rev:3;)
alert tcp $HOME_NET 2208 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR uprising screen control 1.0 runtime detection - begin capture"; flow:from_server,established; flowbits:isset,Uprising_Screen_Control_BeginCapture; content:"/GR"; depth:3; pcre:"/^\x2fGR\d+\x3B\d+/"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453072468; classtype:trojan-activity; sid:7095; rev:3;)
alert tcp $HOME_NET 2208 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR uprising screen control 1.0 runtime detection - init connectiion"; flow:from_server,established; flowbits:isset,Uprising_Screen_Control_InitConnection; content:"/LO"; depth:3; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453072468; classtype:trojan-activity; sid:7093; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2208 (msg:"DELETED BACKDOOR uprising screen control 1.0 runtime detection"; flow:to_server,established; content:"/GR"; depth:3; flowbits:set,Uprising_Screen_Control_BeginCapture; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453072468; classtype:trojan-activity; sid:7094; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2208 (msg:"DELETED BACKDOOR uprising screen control 1.0 runtime detection"; flow:to_server,established; content:"/LR"; depth:3; flowbits:set,Uprising_Screen_Control_InitConnection; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453072468; classtype:trojan-activity; sid:7092; rev:3;)
alert tcp $HOME_NET any -> $AIM_SERVERS any (msg:"DELETED CHAT AIM send message"; flow:to_server,established; content:"*|02|"; depth:2; content:"|00 04 00 06|"; depth:4; offset:6; classtype:policy-violation; sid:1632; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|05|"; depth:1; content:"|0B|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W"; within:16; distance:29; tag:session,5,packets; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,www.microsoft.com/technet/security/bulletin/MS03-039.mspx; classtype:attempted-admin; sid:2251; rev:16;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_repcat_utl.drop_an_object buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_utl.drop_an_object"; nocase; pcre:"/\(\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})/si"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2622; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_repcat_sna_utl.create_snapshot_repgroup buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_sna_utl.create_snapshot_repgroup"; nocase; pcre:"/\(\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})/si"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2623; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_repcat.refresh_mview_repgroup buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.refresh_mview_repgroup"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*gowner[\r\n\s]*=>[\r\n\s]*\2|gowner\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|\(\s*(\x27[^\x27]*\x27|\x22[^\x22]+\x22)\s*,\s*(true|false)\s*,\s*(true|false)\s*,\s*(true|false)\s*,\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,}))/si"; reference:url,www.appsecinc.com/Policy/PolicyCheck90.html; classtype:attempted-user; sid:2631; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_offline_snapshot.end_load buffer overflow attempt"; flow:to_server,established; content:"dbms_offline_snapshot.end_load"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*gname[\r\n\s]*=>[\r\n\s]*\2|gname\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|\(\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,}))/si"; reference:url,www.appsecinc.com/Policy/PolicyCheck632.html; classtype:attempted-user; sid:2635; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_repcat_instantiate.instantiate_online buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_instantiate.instantiate_online"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*refresh_template_name[\r\n\s]*=>[\r\n\s]*\2|refresh_template_name\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|\(\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,}))/si"; classtype:attempted-user; sid:2647; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_repcat_rgt.drop_site_instantiation buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_rgt.drop_site_instantiation"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*refresh_template_name[\r\n\s]*=>[\r\n\s]*\2|refresh_template_name\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|\(\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,}))/si"; classtype:attempted-user; sid:2676; rev:2;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE sys.dbms_rectifier_diff.differences buffer overflow attempt"; flow:to_server,established; content:"sys.dbms_rectifier_diff.differences"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*missing_rows_oname1[\r\n\s]*=>[\r\n\s]*\2|missing_rows_oname1\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|(\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1024,}\x27|\x22[^\x22]{1024,}\x22)[\r\n\s]*\x3b.*sname1[\r\n\s]*=>[\r\n\s]*\2|sname1\s*=>\s*(\x27[^\x27]{1024,}|\x22[^\x22]{1024,})|\(\s*((\x27[^\x27]*\x27|\x22[^\x22]+\x22)\s*,\s*){9}(\x27[^\x27]{1024,}|\x22[^\x22]{1024,}))/si"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2686; rev:2;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE numtoyminterval buffer overflow attempt"; flow:to_server,established; content:"numtoyminterval"; nocase; pcre:"/numtoyminterval\s*\(\s*\d+\s*,\s*(\x27[^\x27]{32}|\x22[^\x22]{32})/smi"; classtype:attempted-user; sid:2700; rev:2;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE dbms_offline_og.begin_load buffer overflow attempt"; flow:to_server,established; content:"dbms_offline_og.begin_load"; nocase; pcre:"/((\w+)[\r\n\s]*\x3a=[\r\n\s]*(\x27[^\x27]{1075,}\x27|\x22[^\x22]{1075,}\x22)[\r\n\s]*\x3b.*gname[\r\n\s]*=>[\r\n\s]*\2|gname\s*=>\s*(\x27[^\x27]{1075,}|\x22[^\x22]{1075,})|\(\s*(\x27[^\x27]{1075,}|\x22[^\x22]{1075,}))/si"; reference:url,www.appsecinc.com/resources/alerts/oracle/2004-0001/25.html; classtype:attempted-user; sid:2710; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI NPH-publish access"; flow:to_server,established; uricontent:"/nph-publish"; nocase; reference:cve,1999-1177; reference:nessus,10164; classtype:attempted-recon; sid:830; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI pfdisplay.cgi access"; flow:to_server,established; uricontent:"/pfdispaly.cgi"; nocase; reference:bugtraq,64; reference:cve,1999-0270; reference:nessus,10174; classtype:attempted-recon; sid:841; rev:10;)
alert tcp $HOME_NET 146 -> $EXTERNAL_NET 1000:1300 (msg:"DELETED BACKDOOR Infector 1.6 Server to Client"; flow:established,from_server; content:"WHATISIT"; reference:cve,1999-0660; reference:nessus,11157; classtype:misc-activity; sid:120; rev:9;)
alert tcp $HOME_NET 30100:30102 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR NetSphere 1.31.337 access"; flow:from_server,established; content:"NetSphere"; reference:arachnids,76; classtype:misc-activity; sid:155; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED BACKDOOR charon runtime detection - download log"; flow:from_server,established; flowbits:isset,backdoor.charon.download.log.2; content:"SEND|7C|"; depth:5; nocase; flowbits:unset,backdoor.charon.download.log.2; reference:url,vil.nai.com/vil/content/v_138997.htm; classtype:trojan-activity; sid:7063; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR charon runtime detection - download log flowbit 2"; flow:to_server,established; flowbits:isset,backdoor.charon.download.log.1; content:"FREQ|7C|"; depth:5; nocase; pcre:"/^FREQ\|\d+/smi"; flowbits:set,backdoor.charon.download.log.2; flowbits:noalert; flowbits:unset,backdoor.charon.download.1; reference:url,vil.nai.com/vil/content/v_138997.htm; classtype:trojan-activity; sid:7062; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR net devil 1.4 runtime detection - initial connection"; flow:from_server,established; flowbits:isset,NetDevil_Init2; content:"ver1.4"; nocase; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453087652; classtype:trojan-activity; sid:7781; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED BACKDOOR net devil 1.4 runtime detection - initial connection - flowbit set 2"; flow:to_server,established; flowbits:isset,NetDevil_Init1; content:"version"; nocase; flowbits:set,NetDevil_Init2; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453087652; classtype:trojan-activity; sid:7780; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2208 (msg:"DELETED BACKDOOR screen control 1.0 runtime detection - capture on port 2208 - flowbit set"; flow:to_server,established; content:"/GR"; flowbits:set,ScreenControl_conn; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453080930; classtype:trojan-activity; sid:7666; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR net devil 1.4 runtime detection - initial connection - flowbit set 1"; flow:from_server,established; content:"passed"; depth:6; nocase; flowbits:set,NetDevil_Init1; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453087652; classtype:trojan-activity; sid:7779; rev:2;)
alert tcp $HOME_NET 1020 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR vampire runtime detection"; flow:from_server,established; flowbits:isset,backdoor.vampire.runtime.detection; content:"Vampire"; depth:7; nocase; content:"Server On-Line....."; distance:0; nocase; pcre:"/^Vampire\s+v\d+\x2E\d+\s+Server\s+On-Line\x2E\x2E\x2E\x2E\x2E/i"; reference:url,www.megasecurity.org/trojans/v/vampire/Vampire1.2.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=6513; classtype:trojan-activity; sid:7110; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1020 (msg:"DELETED BACKDOOR vampire runtime detection"; flow:to_server,established; content:"Hello..."; depth:8; nocase; flowbits:set,backdoor.vampire.runtime.detection; flowbits:noalert; reference:url,www.megasecurity.org/trojans/v/vampire/Vampire1.2.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=6513; classtype:trojan-activity; sid:7109; rev:3;)
alert tcp $HOME_NET 23032 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR amanda 2.0 runtime detection - initial connection"; flow:from_server,established; content:"Connected"; depth:9; nocase; content:"To"; distance:0; nocase; content:"Amanda"; distance:0; nocase; pcre:"/^Connected\s+To\s+Amanda\s+\d+\x2E\d+/smi"; reference:url,www.spywareguide.com/product_show.php?id=1374; classtype:trojan-activity; sid:7056; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED BACKDOOR y3k 1.2 runtime detection - icq notification"; flow:to_server,established; content:"from=Y3K"; nocase; content:"Server"; distance:0; nocase; content:"fromemail=y3k"; distance:0; nocase; content:"subject=Y3K"; distance:0; nocase; content:"online"; distance:0; nocase; reference:url,www.spywareguide.com/product_show.php?id=828; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=33151; classtype:trojan-activity; sid:7117; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS .asp HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/"; nocase; uricontent:".asp"; nocase; content:"|3A|"; content:"|0A|"; content:"|00|"; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,www.microsoft.com/technet/security/bulletin/MS02-018.mspx; classtype:web-application-attack; sid:1801; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS %2E-asp access"; flow:to_server,established; content:"%2easp"; nocase; reference:bugtraq,1814; reference:cve,1999-0253; classtype:web-application-activity; sid:972; rev:10;)
alert tcp $EXTERNAL_NET 1024: -> $HOME_NET 2589 (msg:"DELETED BACKDOOR - Dagger_1.4.0_client_connect"; flow:to_server,established; content:"|0B 00 00 00 07 00 00 00|Connect"; depth:16; reference:arachnids,483; reference:url,www.tlsecurity.net/backdoor/Dagger.1.4.html; classtype:misc-activity; sid:104; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5032 (msg:"DELETED BACKDOOR NetMetro File List"; flow:to_server,established; content:"--"; reference:arachnids,79; classtype:misc-activity; sid:159; rev:7;)
# alert ip any any -> any any (msg:"DELETED BAD-TRAFFIC same SRC/DST"; sameip; reference:bugtraq,2666; reference:cve,1999-0016; reference:url,www.cert.org/advisories/CA-1997-28.html; classtype:bad-unknown; sid:527; rev:10;)
# alert udp any 4000 -> any any (msg:"DELETED EXPLOIT ICQ SRV_MULTI/SRV_META_USER first name overflow attempt"; content:"|05 00|"; depth:2; content:"|12 02|"; within:2; distance:5; byte_test:1,>,1,12,relative; content:"|05 00|"; distance:0; content:"n|00|"; within:2; distance:5; content:"|05 00|"; content:"|DE 03|"; within:2; distance:5; byte_test:2,>,128,18,relative,little; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:2443; rev:6;)
# alert udp any 4000 -> any any (msg:"DELETED EXPLOIT ICQ SRV_MULTI/SRV_META_USER first name overflow attempt"; content:"|05 00|"; depth:2; content:"|12 02|"; within:2; distance:5; byte_test:1,>,1,12,relative; content:"|05 00|"; distance:0; content:"n|00|"; within:2; distance:5; content:"|05 00|"; content:"|DE 03|"; within:2; distance:5; byte_jump:2,18,relative,little; byte_test:2,>,128,0,relative,little; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:2444; rev:6;)
# alert udp any 4000 -> any any (msg:"DELETED EXPLOIT ICQ SRV_MULTI/SRV_META_USER last name overflow attempt"; content:"|05 00|"; depth:2; byte_test:2,>,128,0,relative,little; content:"|12 02|"; within:2; distance:5; byte_test:1,>,1,12,relative; content:"|05 00|"; distance:0; content:"n|00|"; within:2; distance:5; content:"|05 00|"; content:"|DE 03|"; within:2; distance:5; byte_jump:2,18,relative,little; byte_jump:2,0,relative,little; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:2445; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"DELETED SMTP Client_Hello overflow attempt"; flow:to_server,established; content:"|01|"; depth:1; offset:2; byte_test:2,>,0,6; byte_test:2,!,0,8; byte_test:2,!,16,8; byte_test:2,>,20,10; content:"|8F|"; depth:1; offset:11; byte_test:2,>,32768,0,relative; reference:bugtraq,10116; reference:cve,2003-0719; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:2519; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"DELETED SMTP SSLv3 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv3.client_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; flowbits:set,sslv3.client_hello.request; flowbits:noalert; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:protocol-command-decode; sid:2538; rev:3;)
# alert tcp $SMTP_SERVERS 465 -> $EXTERNAL_NET any (msg:"DELETED SMTP SSLv3 Server_Hello request"; flow:to_client,established; flowbits:isset,sslv3.client_hello.request; content:"|16 03|"; depth:2; content:"|02|"; depth:1; offset:5; flowbits:set,sslv3.server_hello.request; flowbits:noalert; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:protocol-command-decode; sid:2539; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"DELETED SMTP SSLv3 invalid Client_Hello attempt"; flow:to_server,established; flowbits:isset,sslv3.server_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2540; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP From command overflow attempt"; flow:to_server,established; content:"From"; nocase; pcre:"/^From\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2591; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP ReplyTo command overflow attempt"; flow:to_server,established; content:"ReplyTo"; nocase; pcre:"/^ReplyTo\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2592; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP Sender command overflow attempt"; flow:to_server,established; content:"Sender"; nocase; pcre:"/^Sender\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2593; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP To command overflow attempt"; flow:to_server,established; content:"To"; nocase; pcre:"/^To\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2594; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP CC command overflow attempt"; flow:to_server,established; content:"CC"; nocase; pcre:"/^CC\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2595; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP BCC command overflow attempt"; flow:to_server,established; content:"BCC"; nocase; pcre:"/^BCC\s{65,}\x3a/smi"; reference:bugtraq,10291; reference:cve,2004-0400; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:2596; rev:4;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED DOS Jolt attack"; dsize:408; fragbits:M; reference:cve,1999-0345; classtype:attempted-dos; sid:268; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED DOS Teardrop attack"; fragbits:M; id:242; reference:bugtraq,124; reference:cve,1999-0015; reference:nessus,10279; reference:url,www.cert.org/advisories/CA-1997-28.html; classtype:attempted-dos; sid:270; rev:9;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED DOS IGMP dos attack"; fragbits:M+; ip_proto:2; reference:bugtraq,514; reference:cve,1999-0918; classtype:attempted-dos; sid:273; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 15104 (msg:"DELETED DDOS mstream client to handler"; flow:stateless; flags:S,12; reference:arachnids,111; reference:cve,2000-0138; classtype:attempted-dos; sid:249; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI MachineInfo access"; flow:to_server,established; uricontent:"/MachineInfo"; nocase; reference:cve,1999-1067; classtype:attempted-recon; sid:893; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI /cart/cart.cgi access"; flow:to_server,established; uricontent:"/cart/cart.cgi"; reference:bugtraq,1115; reference:cve,2000-0252; classtype:web-application-activity; sid:1553; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI campus access"; flow:to_server,established; uricontent:"/campus"; nocase; reference:bugtraq,1975; reference:cve,1999-0146; reference:nessus,10035; classtype:web-application-activity; sid:1653; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS /isapi/tstisapi.dll access"; flow:to_server,established; uricontent:"/isapi/tstisapi.dll"; nocase; reference:bugtraq,2381; reference:cve,2001-0302; classtype:web-application-activity; sid:1484; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"DELETED WEB-CLIENT HTML Help ActiveX Object Access"; flow:from_server,established; content:"adb880a6-d8ff-11cf-9377-00aa003b7a11"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*adb880a6-d8ff-11cf-9377-00aa003b7a11/si"; reference:bugtraq,11467; reference:bugtraq,4857; reference:bugtraq,5874; reference:cve,2002-0693; reference:cve,2002-0823; reference:cve,2004-1043; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB828750; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;Q293338; reference:url,www.microsoft.com/technet/security/bulletin/MS02-055.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-001.mspx; classtype:attempted-user; sid:4149; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC cgitest.exe attempt"; flow:to_server,established; uricontent:"/cgitest.exe|0D 0A|user"; nocase; reference:arachnids,265; reference:bugtraq,1313; reference:bugtraq,3885; reference:cve,2000-0521; reference:cve,2002-0128; reference:nessus,10040; reference:nessus,10623; classtype:web-application-attack; sid:1182; rev:19;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC http directory traversal"; flow:to_server,established; content:"../"; reference:arachnids,297; classtype:attempted-recon; sid:1113; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"DELETED WEB-MISC SSLv3 invalid data version attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; content:!"|03|"; depth:1; offset:9; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2505; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"DELETED WEB-MISC TLS1 Client_Hello with pad via SSLv2 handshake request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tls1.client_hello.request; byte_test:1,<,128,0; content:"|01|"; depth:1; offset:3; content:"|03 01|"; depth:2; offset:4; flowbits:set,tls1.client_hello.request; flowbits:noalert; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:protocol-command-decode; sid:3060; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /bin/ps command attempt"; flow:to_server,established; uricontent:"/bin/ps"; nocase; classtype:web-application-attack; sid:1328; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS ps command attempt"; flow:to_server,established; uricontent:"ps%20"; nocase; classtype:web-application-attack; sid:1329; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS wget command attempt"; flow:to_server,established; content:"wget%20"; nocase; reference:bugtraq,10361; classtype:web-application-attack; sid:1330; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS uname -a command attempt"; flow:to_server,established; content:"uname%20-a"; nocase; classtype:web-application-attack; sid:1331; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/id command attempt"; flow:to_server,established; content:"/usr/bin/id"; nocase; classtype:web-application-attack; sid:1332; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS id command attempt"; flow:to_server,established; content:"|3B|id"; nocase; classtype:web-application-attack; sid:1333; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS echo command attempt"; flow:to_server,established; content:"/bin/echo"; nocase; classtype:web-application-attack; sid:1334; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS kill command attempt"; flow:to_server,established; content:"/bin/kill"; nocase; classtype:web-application-attack; sid:1335; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS chmod command attempt"; flow:to_server,established; content:"/bin/chmod"; nocase; classtype:web-application-attack; sid:1336; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS chgrp command attempt"; flow:to_server,established; content:"/chgrp"; nocase; classtype:web-application-attack; sid:1337; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS chown command attempt"; flow:to_server,established; content:"/chown"; nocase; classtype:web-application-attack; sid:1338; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS chsh command attempt"; flow:to_server,established; content:"/usr/bin/chsh"; nocase; classtype:web-application-attack; sid:1339; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS tftp command attempt"; flow:to_server,established; content:"tftp%20"; nocase; classtype:web-application-attack; sid:1340; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/gcc command attempt"; flow:to_server,established; content:"/usr/bin/gcc"; nocase; classtype:web-application-attack; sid:1341; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS gcc command attempt"; flow:to_server,established; content:"gcc%20-o"; nocase; classtype:web-application-attack; sid:1342; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/cc command attempt"; flow:to_server,established; content:"/usr/bin/cc"; nocase; classtype:web-application-attack; sid:1343; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS cc command attempt"; flow:to_server,established; content:"cc%20"; nocase; classtype:web-application-attack; sid:1344; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/cpp command attempt"; flow:to_server,established; content:"/usr/bin/cpp"; nocase; classtype:web-application-attack; sid:1345; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS cpp command attempt"; flow:to_server,established; content:"cpp%20"; nocase; classtype:web-application-attack; sid:1346; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/g++ command attempt"; flow:to_server,established; content:"/usr/bin/g++"; nocase; classtype:web-application-attack; sid:1347; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS g++ command attempt"; flow:to_server,established; content:"g++%20"; nocase; classtype:web-application-attack; sid:1348; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS bin/python access attempt"; flow:to_server,established; content:"bin/python"; nocase; classtype:web-application-attack; sid:1349; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS python access attempt"; flow:to_server,established; content:"python%20"; nocase; classtype:web-application-attack; sid:1350; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS bin/tclsh execution attempt"; flow:to_server,established; content:"bin/tclsh"; nocase; classtype:web-application-attack; sid:1351; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS tclsh execution attempt"; flow:to_server,established; content:"tclsh8%20"; nocase; classtype:web-application-attack; sid:1352; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS bin/nasm command attempt"; flow:to_server,established; content:"bin/nasm"; nocase; classtype:web-application-attack; sid:1353; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS nasm command attempt"; flow:to_server,established; content:"nasm%20"; nocase; classtype:web-application-attack; sid:1354; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /usr/bin/perl execution attempt"; flow:to_server,established; content:"/usr/bin/perl"; nocase; classtype:web-application-attack; sid:1355; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS perl execution attempt"; flow:to_server,established; content:"perl%20"; nocase; classtype:web-application-attack; sid:1356; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS nt admin addition attempt"; flow:to_server,established; content:"net localgroup administrators /add"; nocase; classtype:web-application-attack; sid:1357; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS traceroute command attempt"; flow:to_server,established; content:"traceroute%20"; nocase; classtype:web-application-attack; sid:1358; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS ping command attempt"; flow:to_server,established; content:"/bin/ping"; nocase; classtype:web-application-attack; sid:1359; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS netcat command attempt"; flow:to_server,established; content:"nc%20"; nocase; classtype:web-application-attack; sid:1360; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS nmap command attempt"; flow:to_server,established; content:"nmap%20"; nocase; classtype:web-application-attack; sid:1361; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS xterm command attempt"; flow:to_server,established; content:"/usr/X11R6/bin/xterm"; nocase; classtype:web-application-attack; sid:1362; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS X application to remote host attempt"; flow:to_server,established; content:"%20-display%20"; nocase; classtype:web-application-attack; sid:1363; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS lsof command attempt"; flow:to_server,established; content:"lsof%20"; nocase; classtype:web-application-attack; sid:1364; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS rm command attempt"; flow:to_server,established; content:"rm%20"; nocase; classtype:web-application-attack; sid:1365; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS mail command attempt"; flow:to_server,established; content:"/bin/mail"; nocase; classtype:web-application-attack; sid:1366; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS mail command attempt"; flow:to_server,established; content:"mail%20"; nocase; classtype:web-application-attack; sid:1367; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /bin/ls| command attempt"; flow:to_server,established; uricontent:"/bin/ls|7C|"; nocase; classtype:web-application-attack; sid:1368; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /bin/ls command attempt"; flow:to_server,established; uricontent:"/bin/ls"; nocase; classtype:web-application-attack; sid:1369; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /etc/inetd.conf access"; flow:to_server,established; content:"/etc/inetd.conf"; nocase; classtype:web-application-activity; sid:1370; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /etc/motd access"; flow:to_server,established; content:"/etc/motd"; nocase; classtype:web-application-activity; sid:1371; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS /etc/shadow access"; flow:to_server,established; content:"/etc/shadow"; nocase; classtype:web-application-activity; sid:1372; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-ATTACKS conf/httpd.conf attempt"; flow:to_server,established; content:"conf/httpd.conf"; nocase; classtype:web-application-activity; sid:1373; rev:8;)
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED ICMP Large ICMP Packet"; dsize:>800; reference:arachnids,246; classtype:bad-unknown; sid:499; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS Samba clientaccess"; flow:to_server,established; content:"|00|Unix|00|Samba"; reference:arachnids,341; classtype:not-suspicious; sid:539; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCEPRC ORPCThis request flood attempt"; flow:to_server,established; content:"|05|"; content:"|00|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|05|"; within:1; distance:21; content:"MEOW"; flowbits:isset,dce.isystemactivator.bind.call.attempt; threshold:type both, track by_dst, count 20, seconds 60; reference:bugtraq,8811; reference:cve,2003-0813; reference:nessus,12206; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:misc-attack; sid:2494; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB DCEPRC ORPCThis request flood attempt"; flow:to_server,established; content:"|05|"; content:"|00|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|05|"; within:1; distance:21; content:"MEOW"; flowbits:isset,dce.isystemactivator.bind.call.attempt; threshold:type both, track by_dst, count 20, seconds 60; reference:bugtraq,8811; reference:cve,2003-0813; reference:nessus,12206; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:misc-attack; sid:2495; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS DCEPRC ORPCThis request flood attempt"; flow:to_server,established; content:"|05|"; content:"|00|"; within:1; distance:1; byte_test:1,&,1,0,relative; content:"|05|"; within:1; distance:21; content:"MEOW"; flowbits:isset,dce.isystemactivator.bind.call.attempt; threshold:type both, track by_dst, count 20, seconds 60; reference:bugtraq,8811; reference:cve,2003-0813; reference:nessus,12206; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:misc-attack; sid:2496; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3251; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3248; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3270; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3255; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3265; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3268; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3250; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3264; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB irot unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3247; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3254; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3269; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB IrotIsRunning unicode andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3262; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB irot unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3246; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3253; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB IrotIsRunning unicode little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3263; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3249; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning unicode little endian andx attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3271; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS irot andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:29; flowbits:set,smb.tree.bind.irot; flowbits:noalert; classtype:protocol-command-decode; sid:3252; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning unicode attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 02|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3266; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS IrotIsRunning unicode little endian attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.irot; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|02 00|"; within:2; distance:19; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,little; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx; classtype:protocol-command-decode; sid:3267; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3707; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3802; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3727; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP veritas little endian alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3771; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3743; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3787; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3794; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3750; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3730; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3726; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3812; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3790; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3713; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3738; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3721; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3766; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3807; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3784; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3712; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP veritas little endian alter context attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3779; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3747; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP veritas little endian bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3704; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP veritas little endian alter context attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3775; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP veritas little endian bind attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3780; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3754; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3799; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3761; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3742; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3808; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3803; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3708; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3793; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3736; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3731; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP veritas little endian bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3772; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3746; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3755; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3737; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3764; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3804; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3765; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3716; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3798; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3783; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3760; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3705; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP veritas little endian bind attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3776; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3759; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3722; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3723; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3741; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3752; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3706; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3786; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3782; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3792; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3735; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3732; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3763; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3810; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3796; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3724; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3719; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3709; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3757; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3809; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP veritas alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3769; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP veritas alter context attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3773; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3728; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP veritas alter context attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3777; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3756; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3768; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3797; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3740; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3710; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3800; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3745; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3715; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3718; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3751; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP veritas alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3701; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3805; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3734; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3791; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3811; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3785; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3762; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3795; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP veritas bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3770; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3725; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3744; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3749; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3788; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3781; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas unicode andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3806; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3801; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3758; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3714; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB veritas WriteAndX unicode alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3789; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP veritas little endian alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3703; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3767; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3711; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3748; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP veritas bind attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3774; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3729; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP veritas bind attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3778; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3720; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3753; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS veritas WriteAndX andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3739; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas unicode little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3733; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP veritas bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3702; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB veritas WriteAndX unicode little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"|D0 1F 84 93 CE 16 CE 11 85 0D 02|`|8C|D|96|{"; distance:29; flowbits:set,dce.bind.veritas; classtype:protocol-command-decode; sid:3717; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3919; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3936; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr little endian alter context attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3906; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP v4 umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4018; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr PNP_QueryResConfList little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4025; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4036; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX little endian andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4046; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3939; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList unicode little endian attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4059; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP v4 umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4019; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3928; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3923; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3944; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3914; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX unicode attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4033; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr little endian bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3903; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3935; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3940; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4029; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList unicode little endian andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4058; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3932; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode little endian alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3896; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT v4 umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3947; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3918; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3927; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr PNP_QueryResConfList little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4021; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX unicode little endian attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4051; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP v4 umpnpmgr PNP_QueryResConfList attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4026; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3913; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3937; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3895; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX little endian andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4030; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3945; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr bind attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3905; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr bind attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3909; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX unicode little endian andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4034; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3933; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP v4 umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3950; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList unicode attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4057; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3920; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr little endian alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3902; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList unicode little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4043; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3941; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3948; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4016; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3917; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP v4 umpnpmgr PNP_QueryResConfList attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4022; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX unicode little endian andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4050; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3924; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode little endian andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3897; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList little endian andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4054; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3892; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode little endian andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3925; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3912; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr alter context attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3908; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX little endian attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4047; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList unicode andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4040; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr bind attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3901; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP v4 umpnpmgr PNP_QueryResConfList little endian attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4023; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3930; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList unicode andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4056; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX little endian alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3916; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3949; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode little endian andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3898; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4044; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3929; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCACN-IP-TCP v4 umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3951; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4031; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4037; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP v4 umpnpmgr PNP_QueryResConfList little endian attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4027; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX unicode little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4035; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr PNP_QueryResConfList little endian attempt"; flow:established,to_server; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4017; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3931; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode andx alter context attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3893; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr little endian bind attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3911; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT v4 umpnpmgr PNP_QueryResConfList attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:3946; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList unicode attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4041; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr PNP_QueryResConfList attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4024; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList little endian attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"6|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4055; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3915; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode little endian bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3943; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 593 (msg:"DELETED NETBIOS DCERPC NCACN-HTTP umpnpmgr alter context attempt"; flow:established,to_server; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3900; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4053; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode andx alter context attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3921; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3938; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr little endian bind attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3907; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX unicode andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4048; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList little endian attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4039; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX unicode attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4049; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_DetectResourceConflict unicode little endian andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"5|00|"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4125; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList unicode little endian andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4042; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3926; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr unicode little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3942; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr PNP_QueryResConfList attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4020; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList andx attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4052; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4028; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr little endian andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3934; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"DELETED NETBIOS DCERPC NCADG-IP-UDP umpnpmgr little endian alter context attempt"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3910; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode andx bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3894; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB v4 umpnpmgr PNP_QueryResConfList WriteAndX attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; within:16; distance:22; content:"|00|6"; within:2; distance:28; pcre:"/^.{10}/sR"; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4045; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr WriteAndX unicode andx bind attempt"; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3922; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList WriteAndX unicode andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_test:2,&,8,15,relative,little; byte_jump:2,25,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00|6"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4032; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED NETBIOS DCERPC DIRECT-UDP umpnpmgr alter context attempt"; content:"|05|"; byte_test:1,!&,16,3,relative; content:"|0E|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3904; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS umpnpmgr unicode little endian bind attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|0B|"; within:1; distance:1; content:"@N|9F 8D|=|A0 CE 11 8F|i|08 00|>0|05 1B|"; distance:29; flowbits:set,dce.bind.umpnpmgr; flowbits:noalert; classtype:protocol-command-decode; sid:3899; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 138 (msg:"DELETED NETBIOS-DG SMB umpnpmgr PNP_QueryResConfList little endian andx attempt"; flowbits:isset,dce.bind.umpnpmgr; content:"|11|"; depth:1; content:"|00|"; distance:13; content:"|00|"; distance:0; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|05|"; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"6|00|"; within:2; distance:19; reference:url,www.microsoft.com/technet/security/bulletin/ms05-039.mspx; classtype:protocol-command-decode; sid:4038; rev:3;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED MISC Tiny Fragments"; dsize:< 25; fragbits:M; classtype:bad-unknown; sid:522; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 PCT Client_Hello overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; content:"|01|"; depth:1; offset:2; byte_test:2,>,0,5; byte_test:2,!,0,7; byte_test:2,!,16,7; byte_test:2,>,20,9; content:"|8F|"; depth:1; offset:11; byte_test:2,>,32768,0,relative; reference:bugtraq,10116; reference:cve,2003-0719; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:2516; rev:14;)
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET 1054 (msg:"DELETED BACKDOOR ACKcmdC trojan scan"; flow:stateless; ack:101058054; flags:A,12; seq:101058054; reference:arachnids,445; classtype:misc-activity; sid:106; rev:11;)
# alert tcp $EXTERNAL_NET 5031 -> $HOME_NET !53:80 (msg:"DELETED BACKDOOR NetMetro Incoming Traffic"; flow:stateless; flags:A+; reference:arachnids,79; classtype:misc-activity; sid:160; rev:8;)
# alert icmp 255.255.255.0/24 any -> $HOME_NET any (msg:"DELETED BACKDOOR SIGNATURE - Q ICMP"; dsize:>1; itype:0; reference:arachnids,202; classtype:misc-activity; sid:183; rev:6;)
# alert tcp 255.255.255.0/24 any -> $HOME_NET any (msg:"DELETED BACKDOOR Q access"; flow:stateless; dsize:>1; flags:A+; reference:arachnids,203; classtype:misc-activity; sid:184; rev:9;)
# alert ip any any -> 216.80.99.202 any (msg:"DELETED BACKDOOR fragroute trojan connection attempt"; reference:bugtraq,4898; classtype:trojan-activity; sid:1791; rev:5;)
# alert tcp any any -> 212.146.0.34 1963 (msg:"DELETED BACKDOOR TCPDUMP/PCAP trojan traffic"; flow:stateless; reference:url,hlug.fscker.com; classtype:trojan-activity; sid:1929; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED BACKDOOR typot trojan traffic"; flow:stateless; flags:S,12; window:55808; reference:mcafee,100406; classtype:trojan-activity; sid:2182; rev:10;)
# alert tcp $TELNET_SERVERS 23 -> $EXTERNAL_NET any (msg:"DELETED INFO TELNET access"; flow:from_server,established; content:"|FF FD|"; rawbytes; content:"|FF FD|"; distance:0; rawbytes; content:"|FF FD|"; distance:0; rawbytes; reference:arachnids,08; reference:cve,1999-0619; reference:nessus,10280; classtype:not-suspicious; sid:716; rev:15;)
# alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"DELETED INFO TELNET Bad Login"; flow:from_server,established; content:"Login incorrect"; nocase; classtype:bad-unknown; sid:1251; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE add_grouped_column ordered sname/oname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.add_grouped_column"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))|((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,)\s*((\x27[^\x27]{1000,})|(\x22[^\x22 ]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck633.html; classtype:attempted-user; sid:2600; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE drop_master_repgroup ordered gname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.drop_master_repgroup"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck87.html; classtype:attempted-user; sid:2602; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE create_mview_repgroup ordered fname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.create_mview_repgroup"; nocase; pcre:"/\(((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,){4}\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck633.html; classtype:attempted-user; sid:2604; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE comment_on_repobject ordered type buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.comment_on_repobject"; nocase; pcre:"/\((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,){2}\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rsmi"; reference:url,www.appsecinc.com/Policy/PolicyCheck634.html; classtype:attempted-user; sid:2607; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE cancel_statistics ordered sname/oname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.cancel_statistics"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))|((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,)\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck633.html; classtype:attempted-user; sid:2610; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE revoke_surrogate_repcat ordered userid buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_auth.revoke_surrogate_repcat"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2613; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE grant_surrogate_repcat ordered userid buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_auth.grant_surrogate_repcat"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2616; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE alter_mview_propagation ordered gname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.alter_mview_propagation"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck632.html; classtype:attempted-user; sid:2618; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE alter_master_repobject ordered type buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.alter_master_repobject"; nocase; pcre:"/\((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,){2}\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rsmi"; reference:url,www.appsecinc.com/Policy/PolicyCheck634.html; classtype:attempted-user; sid:2620; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE unregister_user_repgroup ordered privilege_type buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_admin.unregister_user_repgroup"; nocase; pcre:"/\(((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,)\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck94.html; classtype:attempted-user; sid:2625; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE repcat_import_check ordered gowner/gname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.repcat_import_check"; nocase; pcre:"/\((\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))|\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,\s*(true|false)\s*,\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck90.html; classtype:attempted-user; sid:2628; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE register_user_repgroup ordered privilege_type buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat_admin.register_user_repgroup"; nocase; pcre:"/\(((\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,)\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,})))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck94.html; classtype:attempted-user; sid:2630; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE refresh_mview_repgroup ordered gowner buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.refresh_mview_repgroup"; nocase; pcre:"/\(\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,(\s*(true|false)\s*,\s*){3}((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck90.html; classtype:attempted-user; sid:2632; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE rectifier_diff ordered sname1 buffer overflow attempt"; flow:to_server,established; content:"dbms_rectifier_diff"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck97.html; classtype:attempted-user; sid:2634; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE snapshot.end_load ordered gname buffer overflow attempt"; flow:to_server,established; content:"dbms_offline_snapshot.end_load"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck632.html; classtype:attempted-user; sid:2636; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE drop_master_repobject ordered type buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.drop_master_repobject"; nocase; pcre:"/\((\s*(\x27[^\x27]*\x27|\x22[^\x22]+\x22)\s*,){2}\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rsmi"; reference:url,www.appsecinc.com/Policy/PolicyCheck634.html; classtype:attempted-user; sid:2638; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE drop_mview_repgroup ordered gowner/gname buffer overflow attempt"; flow:to_server,established; content:"dbms_repcat.drop_mview_repgroup"; nocase; pcre:"/\(\s*(\x27[^\x27]*'|\x22[^\x22]+\x22)\s*,\s*(true|false)\s*,\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck90.html; classtype:attempted-user; sid:2640; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE drop_site_instantiation ordered refresh_template_name buffer overflow attempt"; flow:to_server,established; content:"drop_site_instantiation"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck629.html; classtype:attempted-user; sid:2642; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE instantiate_offline ordered refresh_template_name buffer overflow attempt"; flow:to_server,established; content:"instantiate_offline"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck630.html; classtype:attempted-user; sid:2646; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE instantiate_online ordered refresh_template_name buffer overflow attempt"; flow:to_server,established; content:"instantiate_online"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck631.html; classtype:attempted-user; sid:2648; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE og.begin_load ordered gname buffer overflow attempt"; flow:to_server,established; content:"dbms_offline_og.begin_load"; nocase; pcre:"/\(\s*((\x27[^\x27]{1000,})|(\x22[^\x22]{1000,}))/Rmsi"; reference:url,www.appsecinc.com/Policy/PolicyCheck632.html; classtype:attempted-user; sid:2653; rev:3;)
# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: deleted.rules,v 1.37.2.1.2.15 2006/11/15 15:12:28 vrtbuild Exp $
#-------------
# DELETED RULES
#-------------
# These signatures have been deleted for various reasons, but we are keeping
# them here for historical purposes.

# Duplicate to 332
# alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"DELETED FINGER probe 0 attempt"; flow:to_server,established; content:"0"; reference:arachnids,378; classtype:attempted-recon; sid:325; rev:5;)

# Duplicate of 512
# alert tcp $HOME_NET 5631 -> $EXTERNAL_NET any (msg:"DELETED MISC Invalid PCAnywhere Login"; flow:from_server,established; content:"Invalid login"; depth:13; offset:5; classtype:unsuccessful-user; sid:511; rev:6;)

# Duplicate of 514
# alert tcp $EXTERNAL_NET any -> $HOME_NET 27374 (msg:"DELETED MISC ramen worm incoming"; flow:established; content:"GET "; depth:8; nocase; reference:arachnids,460; classtype:bad-unknown; sid:506; rev:5;)

# Duplicate of 557
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED INFO Outbound GNUTella client request"; flow:established; content:"GNUTELLA OK"; depth:40; classtype:misc-activity; sid:558; rev:6;)

# Duplicate of 559
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED P2P Inbound GNUTella client request"; flow:established; flags:A+; content:"GNUTELLA CONNECT"; depth:40; classtype:misc-activity; sid:559; rev:8;)

# Duplicate of 844
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"DELETED WEB-MISC O'Reilly args.bat access"; flow:to_server,established; uricontent:"/cgi-dos/args.bat"; nocase; classtype:attempted-recon; sid:1121; rev:6;)

# Yeah, so the one site that was vulnerable to edit.pl aint no more.
# http://packetstorm.widexs.nl/new-exploits/freestats-cgi.txt
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"DELETED WEB-CGI edit.pl access"; flow:to_server,established; uricontent:"/edit.pl"; nocase; reference:bugtraq,2713; classtype:attempted-recon; sid:855; rev:7;)

# duplicate of 987
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"DELETED EXPERIMENTAL WEB-IIS .htr request"; flow:to_server,established; uricontent:".htr"; nocase; reference:bugtraq,4474; reference:cve,2002-0071; reference:nessus,10932; classtype:web-application-activity; sid:1619; rev:9;)

# webmasters suck, so this happens ever so often.  Its really not that bad,
# so lets disable it.
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"DELETED WEB-MISC prefix-get //"; flow:to_server,established; uricontent:"get //"; nocase; classtype:attempted-recon; sid:1114; rev:7;)

# dup of 1660
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"DELETED EXPERIMENTAL WEB-IIS .NET trace.axd access"; flow:to_server,established; uricontent:"/traace.axd"; nocase; classtype:web-application-attack; sid:1749; rev:5;)

# dup
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC iPlanet ../../ DOS attempt"; flow:to_server,established; content:"GET "; depth:4; uricontent:"/../../../../../../../../../../../"; reference:bugtraq,2282; reference:cve,2001-0252; classtype:web-application-attack; sid:1049; rev:12;)


# Falses WAAAYYY too often.
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"DELETED ATTACK RESPONSES directory listing"; flow:from_server,established; content:"Directory of"; nocase; classtype:unknown; sid:496; rev:9;)

# Replaced with 1801,1802,1803,1804
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS header field buffer overflow attempt"; flow:to_server,established; content:"|3A|"; content:"|0A|"; content:"|00|"; reference:bugtraq,4476; reference:cve,2002-0150; classtype:web-application-attack; sid:1768; rev:8;)

# duplicate of sid:1673
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS (msg:"DELETED ORACLE execute_system attempt"; flow:to_server,established; content:"EXECUTE_SYSTEM"; nocase; classtype:protocol-command-decode; sid:1698; rev:5;)

# Port based only sigs suck, this is why stream4 has flow logs
# alert tcp $EXTERNAL_NET 6000:6005 -> $HOME_NET any (msg:"DELETED X11 outbound client connection detected"; flow:established; reference:arachnids,126; classtype:misc-activity; sid:1227; rev:6;)

# basically duplicate of 330
# alert tcp $EXTERNAL_NET any -> $HOME_NET 79 (msg:"DELETED FINGER cybercop redirection"; flow:to_server,established; dsize:11; content:"@localhost|0A|"; reference:arachnids,11; classtype:attempted-recon; sid:329; rev:10;)

# duplicate of 1478
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI swc attempt"; flow:to_server,established; uricontent:"/swc"; nocase; classtype:attempted-recon; sid:1477; rev:6;)

# duplicate of 1248
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-FRONTPAGE rad overflow attempt"; flow:to_server,established; dsize:>258; uricontent:"/fp30reg.dll"; nocase; reference:arachnids,555; reference:bugtraq,2906; reference:cve,2001-0341; reference:url,www.microsoft.com/technet/security/bulletin/MS01-035.mspx; classtype:web-application-attack; sid:1246; rev:16;)

# duplicate of 1249
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-FRONTPAGE rad overflow attempt"; flow:to_server,established; dsize:>259; uricontent:"/fp4areg.dll"; nocase; reference:bugtraq,2906; reference:cve,2001-0341; classtype:web-application-attack; sid:1247; rev:13;)

# duplicate of 1755
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT partial body overflow attempt"; flow:to_server,established; dsize:>1092; content:" x PARTIAL 1 BODY["; reference:bugtraq,4713; reference:cve,2002-0379; classtype:misc-attack; sid:1780; rev:11;)

# duplicate of 1538
# alert tcp $EXTERNAL_NET any -> $HOME_NET 119 (msg:"DELETED NNTP Cassandra Overflow"; flow:to_server,established; dsize:>512; content:"AUTHINFO USER"; depth:16; nocase; reference:arachnids,274; reference:bugtraq,1156; reference:cve,2000-0341; classtype:attempted-user; sid:291; rev:14;)

# This rule looks for the exploit for w3-msql, but very badly
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI w3-msql solaris x86  access"; flow:to_server,established; uricontent:"/bin/shA-cA/usr/openwin"; nocase; reference:arachnids,211; reference:cve,1999-0276; classtype:attempted-recon; sid:874; rev:8;)


# alert udp $EXTERNAL_NET any -> $HOME_NET 67 (msg:"DELETED EXPLOIT bootp x86 bsd overfow"; content:"echo netrjs stre"; reference:bugtraq,324; reference:cve,1999-0914; classtype:attempted-admin; sid:318; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 67 (msg:"DELETED EXPLOIT bootp x86 linux overflow"; content:"A90|C0 A8 01 01|/bin/sh|00|"; reference:cve,1999-0389; reference:cve,1999-0798; reference:cve,1999-0799; classtype:attempted-admin; sid:319; rev:6;)


# duplicate of 109
# alert tcp $HOME_NET 12346 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR netbus active"; flow:established; flags:A+; content:"NetBus"; reference:arachnids,401; classtype:misc-activity; sid:114; rev:7;)

# duplicate of 110
# alert tcp $EXTERNAL_NET any -> $HOME_NET 12346 (msg:"DELETED BACKDOOR netbus getinfo"; flow:to_server,established; content:"GetInfo|0D|"; reference:arachnids,403; classtype:misc-activity; sid:111; rev:6;)


# we have a backorifice preprocessor
# alert tcp $HOME_NET 80 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR BackOrifice access"; flow:established; flags:A+; content:"server|3A| BO/"; reference:arachnids,400; classtype:misc-activity; sid:112; rev:8;)

# we have a backorifice preprocessor
# alert udp $EXTERNAL_NET any -> $HOME_NET 31337 (msg:"DELETED BACKDOOR BackOrifice access"; content:"|CE|c|D1 D2 16 E7 13 CF|9|A5 A5 86|"; reference:arachnids,399; classtype:misc-activity; sid:116; rev:6;)



# alert udp $EXTERNAL_NET 2140 -> $HOME_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Active on Network"; reference:arachnids,106; classtype:misc-activity; sid:164; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Keylogger on Server ON"; content:"KeyLogger Is Enabled On port"; reference:arachnids,106; classtype:misc-activity; sid:165; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Show Picture Client Request"; content:"22"; reference:arachnids,106; classtype:misc-activity; sid:166; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide/Show Clock Client Request"; content:"32"; reference:arachnids,106; classtype:misc-activity; sid:167; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide/Show Desktop Client Request"; content:"33"; reference:arachnids,106; classtype:misc-activity; sid:168; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Swap Mouse Buttons Client Request"; content:"34"; reference:arachnids,106; classtype:misc-activity; sid:169; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Enable/Disable CTRL-ALT-DEL Client Request"; content:"110"; reference:arachnids,106; classtype:misc-activity; sid:170; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Freeze Mouse Client Request"; content:"35"; reference:arachnids,106; classtype:misc-activity; sid:171; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Show Dialog Box Client Request"; content:"70"; reference:arachnids,106; classtype:misc-activity; sid:172; rev:7;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Show Replyable Dialog Box Client Request"; content:"71"; reference:arachnids,106; classtype:misc-activity; sid:173; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide/Show Start Button Client Request"; content:"31"; reference:arachnids,106; classtype:misc-activity; sid:174; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Resolution Change Client Request"; content:"125"; reference:arachnids,106; classtype:misc-activity; sid:175; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide/Show Start Button Client Request"; content:"04"; reference:arachnids,106; classtype:misc-activity; sid:176; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Keylogger on Server OFF"; content:"KeyLogger Shut Down"; reference:arachnids,106; classtype:misc-activity; sid:177; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 FTP Server Port Client Request"; content:"21"; reference:arachnids,106; classtype:misc-activity; sid:179; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Process List Client request"; content:"64"; reference:arachnids,106; classtype:misc-activity; sid:180; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Close Port Scan Client Request"; content:"121"; reference:arachnids,106; classtype:misc-activity; sid:181; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Registry Add Client Request"; content:"89"; reference:arachnids,106; classtype:misc-activity; sid:182; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 System Info Client Request"; content:"13"; reference:arachnids,106; classtype:misc-activity; sid:122; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 FTP Status Client Request"; content:"09"; reference:arachnids,106; classtype:misc-activity; sid:124; rev:6;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 E-Mail Info From Server"; content:"Retreaving"; reference:arachnids,106; classtype:misc-activity; sid:125; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 E-Mail Info Client Request"; content:"12"; reference:arachnids,106; classtype:misc-activity; sid:126; rev:6;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Status From Server"; content:"Host"; reference:arachnids,106; classtype:misc-activity; sid:127; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Status Client Request"; content:"10"; reference:arachnids,106; classtype:misc-activity; sid:128; rev:6;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Drive Info From Server"; content:"C - "; reference:arachnids,106; classtype:misc-activity; sid:129; rev:6;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 System Info From Server"; content:"Comp Name"; reference:arachnids,106; classtype:misc-activity; sid:130; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Drive Info Client Request"; content:"130"; reference:arachnids,106; classtype:misc-activity; sid:131; rev:6;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server FTP Port Change From Server"; content:"FTP Server changed to"; reference:arachnids,106; classtype:misc-activity; sid:132; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Cached Passwords Client Request"; content:"16"; reference:arachnids,106; classtype:misc-activity; sid:133; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 RAS Passwords Client Request"; content:"17"; reference:arachnids,106; classtype:misc-activity; sid:134; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Password Change Client Request"; content:"91"; reference:arachnids,106; classtype:misc-activity; sid:135; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Password Remove Client Request"; content:"92"; reference:arachnids,106; classtype:misc-activity; sid:136; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Rehash Client Request"; content:"911"; reference:arachnids,106; classtype:misc-activity; sid:137; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 3150 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Rehash Client Request"; content:"shutd0wnM0therF***eR"; reference:arachnids,106; classtype:misc-activity; sid:138; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 ICQ Alert OFF Client Request"; content:"88"; reference:arachnids,106; classtype:misc-activity; sid:140; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 ICQ Alert ON Client Request"; content:"40"; reference:arachnids,106; classtype:misc-activity; sid:142; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Change Wallpaper Client Request"; content:"20"; reference:arachnids,106; classtype:misc-activity; sid:143; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 3150 (msg:"DELETED BACKDOOR DeepThroat 3.1 Client Sending Data to Server on Network"; content:"|00 23|"; reference:arachnids,106; classtype:misc-activity; sid:149; rev:6;)
# alert udp $EXTERNAL_NET 3150 -> $HOME_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Server Active on Network"; content:"|00 23|"; reference:arachnids,106; classtype:misc-activity; sid:150; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Client Sending Data to Server on Network"; reference:arachnids,106; classtype:misc-activity; sid:151; rev:6;)
# alert udp $HOME_NET 3150 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Wrong Password"; content:"Wrong Password"; reference:arachnids,106; classtype:misc-activity; sid:154; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Visible Window List Client Request"; content:"37"; reference:arachnids,106; classtype:misc-activity; sid:156; rev:6;)
# alert udp $EXTERNAL_NET 4120 -> $HOME_NET any (msg:"DELETED BACKDOOR DeepThroat access"; content:"--Ahhhhhhhhhh"; reference:arachnids,405; classtype:misc-activity; sid:113; rev:7;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Monitor on/off Client Request"; content:"07"; reference:arachnids,106; classtype:misc-activity; sid:186; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Delete File Client Request"; content:"41"; reference:arachnids,106; classtype:misc-activity; sid:187; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Kill Window Client Request"; content:"38"; reference:arachnids,106; classtype:misc-activity; sid:188; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Disable Window Client Request"; content:"23"; reference:arachnids,106; classtype:misc-activity; sid:189; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Enable Window Client Request"; content:"24"; reference:arachnids,106; classtype:misc-activity; sid:190; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Change Window Title Client Request"; content:"60"; reference:arachnids,106; classtype:misc-activity; sid:191; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide Window Client Request"; content:"26"; reference:arachnids,106; classtype:misc-activity; sid:192; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Show Window Client Request"; content:"25"; reference:arachnids,106; classtype:misc-activity; sid:193; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Send Text to Window Client Request"; content:"63"; reference:arachnids,106; classtype:misc-activity; sid:194; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Hide/Show Systray Client Request"; content:"30"; reference:arachnids,106; classtype:misc-activity; sid:196; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Create Directory Client Request"; content:"39"; reference:arachnids,106; classtype:misc-activity; sid:197; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 All Window List Client Request"; content:"370"; reference:arachnids,106; classtype:misc-activity; sid:198; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Play Sound Client Request"; content:"36"; reference:arachnids,106; classtype:misc-activity; sid:199; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Run Program Normal Client Request"; content:"14"; reference:arachnids,106; classtype:misc-activity; sid:200; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Run Program Hidden Client Request"; content:"15"; reference:arachnids,106; classtype:misc-activity; sid:201; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Get NET File Client Request"; content:"100"; reference:arachnids,106; classtype:misc-activity; sid:202; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Find File Client Request"; content:"117"; reference:arachnids,106; classtype:misc-activity; sid:203; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 Find File Client Request"; content:"118"; reference:arachnids,106; classtype:misc-activity; sid:204; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 HUP Modem Client Request"; content:"199"; reference:arachnids,106; classtype:misc-activity; sid:205; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 CD ROM Open Client Request"; content:"02"; reference:arachnids,106; classtype:misc-activity; sid:206; rev:6;)
# alert udp $EXTERNAL_NET 60000 -> $HOME_NET 2140 (msg:"DELETED BACKDOOR DeepThroat 3.1 CD ROM Close Client Request"; content:"03"; reference:arachnids,106; classtype:misc-activity; sid:207; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 53 (msg:"DELETED DNS named iquery attempt"; content:"|09 80 00 00 00 01 00 00 00 00|"; depth:16; offset:2; reference:arachnids,277; reference:bugtraq,134; reference:cve,1999-0009; reference:url,www.rfc-editor.org/rfc/rfc1035.txt; classtype:attempted-recon; sid:252; rev:8;)
# alert udp $HOME_NET 2140 -> $EXTERNAL_NET 60000 (msg:"DELETED BACKDOOR DeepThroat 3.1 Keylogger Active on Network"; content:"KeyLogger Is Enabled On port"; reference:arachnids,106; classtype:misc-activity; sid:148; rev:6;)

# The following ftp rules look for specific exploits, which are not needed now
# that initial protocol decoding is available.

# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT format string"; flow:to_server,established; content:"SITE EXEC %020d|7C|%.f%.f|7C 0A|"; depth:32; nocase; reference:arachnids,453; reference:bugtraq,1387; reference:cve,2000-0573; classtype:attempted-user; sid:338; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT OpenBSD x86 ftpd"; flow:to_server,established; content:" |90|1|C0 99|RR|B0 17 CD 80|h|CC|sh"; reference:arachnids,446; reference:bugtraq,2124; reference:cve,2001-0053; classtype:attempted-user; sid:339; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT overflow"; flow:to_server,established; content:"PWD|0A|/i"; classtype:attempted-admin; sid:340; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT overflow"; flow:to_server,established; content:"XXXXX/"; classtype:attempted-admin; sid:341; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0 site exec format string overflow Solaris 2.8"; flow:to_server,established; content:"|90 1B C0 0F 82 10| |17 91 D0| |08|"; reference:arachnids,451; reference:bugtraq,1387; reference:cve,2000-0573; classtype:attempted-user; sid:342; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0 site exec format string overflow FreeBSD"; flow:to_server,established; content:"1|C0|PPP|B0|~|CD 80|1|DB|1|C0|"; depth:32; reference:arachnids,228; reference:bugtraq,1387; reference:cve,2000-0573; classtype:attempted-admin; sid:343; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0 site exec format string overflow Linux"; flow:to_server,established; content:"1|C0|1|DB|1|C9 B0|F|CD 80|1|C0|1|DB|"; reference:arachnids,287; reference:bugtraq,1387; reference:cve,2000-0573; classtype:attempted-admin; sid:344; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0 site exec format string overflow generic"; flow:to_server,established; content:"SITE "; nocase; content:" EXEC "; nocase; content:" %p"; nocase; reference:arachnids,285; reference:bugtraq,1387; reference:cve,2000-0573; reference:nessus,10452; classtype:attempted-admin; sid:345; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0 site exec format string check"; flow:to_server,established; content:"f%.f%.f%.f%.f%."; depth:32; reference:arachnids,286; reference:bugtraq,1387; reference:cve,2000-0573; classtype:attempted-recon; sid:346; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT wu-ftpd 2.6.0"; flow:to_server,established; content:"..11venglin@"; reference:arachnids,440; reference:bugtraq,1387; classtype:attempted-user; sid:348; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT MKD overflow"; flow:to_server,established; content:"MKD AAAAAA"; reference:bugtraq,113; reference:bugtraq,2242; reference:cve,1999-0368; classtype:attempted-admin; sid:349; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"1|C0|1|DB B0 17 CD 80|1|C0 B0 17 CD 80|"; reference:bugtraq,113; reference:bugtraq,2242; reference:cve,1999-0368; classtype:attempted-admin; sid:350; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"1|DB 89 D8 B0 17 CD 80 EB|,"; reference:bugtraq,113; reference:bugtraq,2242; reference:cve,1999-0368; classtype:attempted-admin; sid:351; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|83 EC 04|^|83 C6|p|83 C6 28 D5 E0 C0|"; reference:bugtraq,113; reference:cve,1999-0368; classtype:attempted-admin; sid:352; rev:8;)

# duplicate of 475
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED ICMP Traceroute ipopts"; ipopts:rr; itype:0; reference:arachnids,238; classtype:misc-activity; sid:455; rev:8;)


# not needed thanks to 1964 and 1965
# alert tcp $EXTERNAL_NET any -> $HOME_NET 32771:34000 (msg:"DELETED RPC EXPLOIT ttdbserv solaris overflow"; flow:to_server,established; dsize:>999; content:"|C0 22|?|FC A2 02| |09 C0|,|7F FF E2 22|?|F4|"; reference:arachnids,242; reference:bugtraq,122; reference:cve,1999-0003; reference:url,www.cert.org/advisories/CA-2001-27.html; classtype:attempted-admin; sid:570; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 32771:34000 (msg:"DELETED RPC EXPLOIT ttdbserv Solaris overflow"; flow:to_server,established; dsize:>999; content:"|00 01 86 F3 00 00 00 01 00 00 00 0F 00 00 00 01|"; reference:arachnids,242; reference:bugtraq,122; reference:cve,1999-0003; reference:url,www.cert.org/advisories/CA-2001-27.html; classtype:attempted-admin; sid:571; rev:10;)

# dup of 589
# alert udp $EXTERNAL_NET any -> $HOME_NET 111 (msg:"DELETED RPC portmap request yppasswdd"; rpc:100009,*,*; reference:bugtraq,2763; classtype:rpc-portmap-decode; sid:1296; rev:5;)
# dup of 1275
# alert tcp $EXTERNAL_NET any -> $HOME_NET 111 (msg:"DELETED RPC portmap request yppasswdd"; flow:to_server,established; rpc:100009,*,*; reference:bugtraq,2763; classtype:rpc-portmap-decode; sid:1297; rev:9;)

# dup of 1280
# alert tcp $EXTERNAL_NET any -> $HOME_NET 111 (msg:"DELETED RPC portmap listing"; flow:to_server,established; rpc:100000,*,*; reference:arachnids,429; classtype:rpc-portmap-decode; sid:596; rev:7;)

# dup of 1281
# alert tcp $EXTERNAL_NET any -> $HOME_NET 32771 (msg:"DELETED RPC portmap listing"; flow:to_server,established; rpc:100000,*,*; reference:arachnids,429; classtype:rpc-portmap-decode; sid:597; rev:7;)

# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED BAD TRAFFIC Non-Standard IP protocol"; ip_proto:!1; ip_proto:!2; ip_proto:!47; ip_proto:!50; ip_proto:!51; ip_proto:!6; ip_proto:!89; classtype:non-standard-protocol; sid:1620; rev:6;)

# this has been replaced with sid 1905 and 1906
# alert tcp $EXTERNAL_NET any -> $HOME_NET 634:1400 (msg:"DELETED RPC AMD Overflow"; flow:to_server,established; content:"|80 00 04|,L|15|u[|00 00 00 00 00 00 00 02|"; depth:32; reference:arachnids,217; reference:cve,1999-0704; classtype:attempted-admin; sid:573; rev:9;)

# these have been replaced by 1915, 1916, 1914, and 1913
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED RPC EXPLOIT statdx"; flow:to_server,established; content:"/bin|C7|F|04|/sh"; reference:arachnids,442; classtype:attempted-admin; sid:600; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED RPC EXPLOIT statdx"; content:"/bin|C7|F|04|/sh"; reference:arachnids,442; classtype:attempted-admin; sid:1282; rev:6;)

# duplicate of 1088
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI webstore directory traversal"; flow:to_server,established; uricontent:"/web_store.cgi?page=../.."; reference:bugtraq,1774; reference:cve,2000-1005; classtype:web-application-attack; sid:1094; rev:11;)


# these are obsolete
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT overflow"; flow:to_server,established; content:"|E8 C0 FF FF FF|/bin/sh"; classtype:attempted-admin; sid:293; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|89 D8|@|CD 80 E8 C8 FF FF FF|/"; reference:bugtraq,130; reference:cve,1999-0005; classtype:attempted-admin; sid:295; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|EB|4^|8D 1E 89|^|0B|1|D2 89|V|07|"; reference:bugtraq,130; reference:cve,1999-0005; classtype:attempted-admin; sid:296; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|EB|5^|80|F|01|0|80|F|02|0|80|F|03|0"; reference:bugtraq,130; reference:cve,1999-0005; classtype:attempted-admin; sid:297; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|EB|8^|89 F3 89 D8 80|F|01| |80|F|02|"; reference:bugtraq,130; reference:cve,1999-0005; classtype:attempted-admin; sid:298; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"DELETED IMAP EXPLOIT x86 linux overflow"; flow:to_server,established; content:"|EB|X^1|DB 83 C3 08 83 C3 02 88|^&"; reference:bugtraq,130; reference:cve,1999-0005; classtype:attempted-admin; sid:299; rev:8;)

# what is this rule?  we have no idea...
# alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"DELETED SCAN ssh-research-scanner"; flow:to_server,established; content:"|00 00 00|`|00 00 00 00 00 00 00 00 01 00 00 00|"; classtype:attempted-recon; sid:617; rev:5;)

# These have been replaced by better rules (1915,1916,1913,1914)
# alert udp $EXTERNAL_NET any -> $HOME_NET 32770: (msg:"DELETED RPC rstatd query"; content:"|00 00 00 00 00 00 00 02 00 01 86 A1|"; offset:5; reference:arachnids,9; classtype:attempted-recon; sid:592; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 32770: (msg:"DELETED RPC rstatd query"; flow:to_server,established; content:"|00 00 00 00 00 00 00 02 00 01 86 A1|"; offset:5; reference:arachnids,9; classtype:attempted-recon; sid:1278; rev:6;)

# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"DELETED ATTACK-RESPONSES id check returned nobody"; flow:from_server,established; content:"uid="; content:"|28|nobody|29|"; classtype:bad-unknown; sid:1883; rev:6;)
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"DELETED ATTACK-RESPONSES id check returned web"; flow:from_server,established; content:"uid="; content:"|28|web|29|"; classtype:bad-unknown; sid:1884; rev:6;)
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"DELETED ATTACK-RESPONSES id check returned http"; flow:from_server,established; content:"uid="; content:"|28|http|29|"; classtype:bad-unknown; sid:1885; rev:6;)
# alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"DELETED ATTACK-RESPONSES id check returned apache"; flow:from_server,established; content:"uid="; content:"|28|apache|29|"; classtype:bad-unknown; sid:1886; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB SMB_COM_TRANSACTION Max Data Count of 0 DOS Attempt"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB%"; depth:5; offset:4; content:"|00 00|"; depth:2; offset:45; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,www.corest.com/common/showdoc.php?idx=262; reference:url,www.microsoft.com/technet/security/bulletin/MS02-045.mspx; classtype:denial-of-service; sid:2102; rev:11;)

# specific example for sid:1549
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP EXPLOIT x86 windows CSMMail overflow"; flow:to_server,established; content:"|EB|S|EB| [|FC|3|C9 B1 82 8B F3 80|+"; reference:bugtraq,895; reference:cve,2000-0042; classtype:attempted-admin; sid:656; rev:9;)

# this is properly caught by sid:527
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED DOS Land attack"; flow:stateless; flags:S; id:3868; seq:3868; reference:bugtraq,2666; reference:cve,1999-0016; classtype:attempted-dos; sid:269; rev:11;)

# duplicate of 1546
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC Cisco Web DOS attempt"; flow:to_server,established; content:" /%%"; depth:16; reference:arachnids,275; classtype:attempted-dos; sid:1138; rev:8;)

# these are obsoleted by cleaning up 663
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP sendmail 8.4.1 exploit"; flow:to_server,established; content:"rcpt to|3A| |7C| sed '1,/^|24|/d'|7C|"; nocase; reference:arachnids,120; classtype:attempted-user; sid:666; rev:8;)

# dup of 588
# alert tcp $EXTERNAL_NET any -> $HOME_NET 111 (msg:"DELETED RPC portmap tooltalk request TCP"; flow:to_server,established; content:"|00 00 00 00|"; depth:4; offset:8; content:"|00 01 86 A0|"; depth:4; offset:16; content:"|00 00 00 03|"; within:4; distance:4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F3|"; within:4; reference:bugtraq,3382; reference:cve,1999-0003; reference:cve,1999-0687; reference:cve,1999-1075; reference:cve,2001-0717; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:1298; rev:16;)
# dup of 1274
# alert udp $EXTERNAL_NET any -> $HOME_NET 111 (msg:"DELETED RPC portmap tooltalk request UDP"; content:"|00 00 00 00|"; depth:4; offset:4; content:"|00 01 86 A0|"; depth:4; offset:12; content:"|00 00 00 03|"; within:4; distance:4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F3|"; within:4; reference:bugtraq,3382; reference:cve,1999-0003; reference:cve,1999-0687; reference:cve,1999-1075; reference:cve,2001-0717; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:1299; rev:15;)

# these virus rules suck.
# alert tcp any 110 -> any any (msg:"DELETED Virus - SnowWhite Trojan Incoming"; flow:established; content:"Suddlently"; classtype:misc-activity; sid:720; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NAVIDAD Worm"; flow:established; content:"NAVIDAD.EXE"; nocase; classtype:misc-activity; sid:722; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"myromeo.exe"; nocase; classtype:misc-activity; sid:723; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"myjuliet.chm"; nocase; classtype:misc-activity; sid:724; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"ble bla"; nocase; classtype:misc-activity; sid:725; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"I Love You"; classtype:misc-activity; sid:726; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"Sorry... Hey you !"; classtype:misc-activity; sid:727; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"my picture from shake-beer"; classtype:misc-activity; sid:728; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible QAZ Worm"; flow:established; content:"qazwsx.hsq"; reference:mcafee,98775; classtype:misc-activity; sid:731; rev:9;)
# alert tcp any any -> any 25 (msg:"DELETED Virus - Possible QAZ Worm Calling Home"; flow:established; content:"nongmin_cn"; reference:mcafee,98775; classtype:misc-activity; sid:733; rev:8;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Matrix worm"; flow:established; content:"Software provide by [MATRiX]"; nocase; classtype:misc-activity; sid:734; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyRomeo Worm"; flow:established; content:"Matrix has you..."; classtype:misc-activity; sid:735; rev:7;)
# alert tcp any any -> any 25 (msg:"DELETED Virus - Successful eurocalculator execution"; flow:established; flags:PA; content:"funguscrack@hotmail.com"; nocase; classtype:misc-activity; sid:736; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible eurocalculator.exe file"; flow:established; content:"filename="; content:"eurocalculator.exe"; nocase; classtype:misc-activity; sid:737; rev:7;)
# alert tcp any any -> any 110 (msg:"DELETED Virus - Possible Pikachu Pokemon Virus"; flow:established; flags:PA; content:"Pikachu Pokemon"; reference:mcafee,98696; classtype:misc-activity; sid:738; rev:10;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Triplesix Worm"; flow:established; content:"filename=|22|666TEST.VBS|22|"; nocase; reference:mcafee,10389; classtype:misc-activity; sid:739; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Tune.vbs"; flow:established; content:"filename=|22|tune.vbs|22|"; nocase; reference:mcafee,10497; classtype:misc-activity; sid:740; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NAIL Worm"; flow:established; content:"Market share tipoff"; reference:mcafee,10109; classtype:misc-activity; sid:741; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NAIL Worm"; flow:established; content:"name =|22|WWIII!"; reference:mcafee,10109; classtype:misc-activity; sid:742; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NAIL Worm"; flow:established; content:"New Developments"; reference:mcafee,10109; classtype:misc-activity; sid:743; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NAIL Worm"; flow:established; content:"Good Times"; reference:mcafee,10109; classtype:misc-activity; sid:744; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Papa Worm"; flow:established; content:"filename=|22|XPASS.XLS|22|"; nocase; reference:mcafee,10145; classtype:misc-activity; sid:745; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Freelink Worm"; flow:established; content:"LINKS.VBS"; reference:mcafee,10225; classtype:misc-activity; sid:746; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Simbiosis Worm"; flow:established; content:"filename=|22|SETUP.EXE|22|"; nocase; classtype:misc-activity; sid:747; rev:8;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible BADASS Worm"; flow:established; content:"name =|22|BADASS.EXE|22|"; reference:mcafee,10388; classtype:misc-activity; sid:748; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible ExploreZip.B Worm"; flow:established; content:"name =|22|File_zippati.exe|22|"; reference:mcafee,10471; classtype:misc-activity; sid:749; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible wscript.KakWorm"; flow:established; content:"filename=|22|KAK.HTA|22|"; nocase; reference:mcafee,10509; classtype:misc-activity; sid:751; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus Possible Suppl Worm"; flow:established; content:"filename=|22|Suppl.doc|22|"; nocase; reference:mcafee,10361; classtype:misc-activity; sid:752; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - theobbq.exe"; flow:established; content:"filename=|22|THEOBBQ.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:753; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Word Macro - VALE"; flow:established; content:"filename=|22|MONEY.DOC|22|"; nocase; reference:mcafee,10502; classtype:misc-activity; sid:754; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible IROK Worm"; flow:established; content:"filename=|22|irok.exe|22|"; nocase; reference:mcafee,98552; classtype:misc-activity; sid:755; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Fix2001 Worm"; flow:established; content:"filename=|22|Fix2001.exe|22|"; nocase; reference:mcafee,10355; classtype:misc-activity; sid:756; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Y2K Zelu Trojan"; flow:established; content:"filename=|22|Y2K.EXE|22|"; nocase; reference:mcafee,10505; classtype:misc-activity; sid:757; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible The_Fly Trojan"; flow:established; content:"filename=|22|THE_FLY.CHM|22|"; nocase; reference:mcafee,10478; classtype:misc-activity; sid:758; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Word Macro - VALE"; flow:established; content:"filename=|22|DINHEIRO.DOC|22|"; nocase; reference:mcafee,10502; classtype:misc-activity; sid:759; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Passion Worm"; flow:established; content:"filename=|22|ICQ_GREETINGS.EXE|22|"; nocase; reference:mcafee,10467; classtype:misc-activity; sid:760; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - cooler3.exe"; flow:established; content:"filename=|22|COOLER3.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:761; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - party.exe"; flow:established; content:"filename=|22|PARTY.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:762; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - hog.exe"; flow:established; content:"filename=|22|HOG.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:763; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - goal1.exe"; flow:established; content:"filename=|22|GOAL1.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:764; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - pirate.exe"; flow:established; content:"filename=|22|PIRATE.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:765; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - video.exe"; flow:established; content:"filename=|22|VIDEO.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:766; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - baby.exe"; flow:established; content:"filename=|22|BABY.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:767; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - cooler1.exe"; flow:established; content:"filename=|22|COOLER1.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:768; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - boss.exe"; flow:established; content:"filename=|22|BOSS.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:769; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - g-zilla.exe"; flow:established; content:"filename=|22|G-ZILLA.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:770; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible ToadieE-mail Trojan"; flow:established; content:"filename=|22|Toadie.exe|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:771; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible PrettyPark Trojan"; flow:established; content:"|5C|CoolProgs|5C|"; depth:750; offset:300; reference:mcafee,10175; classtype:misc-activity; sid:772; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Happy99 Virus"; flow:established; content:"X-Spanska|3A|Yes"; reference:mcafee,10144; classtype:misc-activity; sid:773; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible CheckThis Trojan"; flow:established; content:"name =|22|links.vbs|22|"; classtype:misc-activity; sid:774; rev:6;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Bubbleboy Worm"; flow:established; content:"BubbleBoy is back!"; reference:mcafee,10418; classtype:misc-activity; sid:775; rev:8;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - copier.exe"; flow:established; content:"filename=|22|COPIER.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:776; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible MyPics Worm"; flow:established; content:"name =|22|pics4you.exe|22|"; reference:mcafee,10467; classtype:misc-activity; sid:777; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Babylonia - X-MAS.exe"; flow:established; content:"name =|22|X-MAS.EXE|22|"; reference:mcafee,10461; classtype:misc-activity; sid:778; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - gadget.exe"; flow:established; content:"filename=|22|GADGET.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:779; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - irnglant.exe"; flow:established; content:"filename=|22|IRNGLANT.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:780; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - casper.exe"; flow:established; content:"filename=|22|CASPER.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:781; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - fborfw.exe"; flow:established; content:"filename=|22|FBORFW.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:782; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - saddam.exe"; flow:established; content:"filename=|22|SADDAM.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:783; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - bboy.exe"; flow:established; content:"filename=|22|BBOY.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:784; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - monica.exe"; flow:established; content:"filename=|22|MONICA.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:785; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - goal.exe"; flow:established; content:"filename=|22|GOAL.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:786; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - panther.exe"; flow:established; content:"filename=|22|PANTHER.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:787; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - chestburst.exe"; flow:established; content:"filename=|22|CHESTBURST.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:788; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Common Sense Worm"; flow:established; content:"name =|22|THE_FLY.CHM|22|"; classtype:misc-activity; sid:790; rev:8;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - cupid2.exe"; flow:established; content:"filename=|22|CUPID2.EXE|22|"; nocase; reference:mcafee,10540; classtype:misc-activity; sid:791; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Resume Worm"; flow:established; content:"filename=|22|RESUME1.DOC|22|"; nocase; reference:mcafee,98661; classtype:misc-activity; sid:792; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Resume Worm"; flow:established; content:"filename=|22|Explorer.doc|22|"; nocase; reference:mcafee,98661; classtype:misc-activity; sid:794; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Worm -  txt.vbs file"; flow:established; content:"filename="; content:".txt.vbs"; nocase; classtype:misc-activity; sid:795; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Worm - xls.vbs file"; flow:established; content:"filename="; content:".xls.vbs"; nocase; classtype:misc-activity; sid:796; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Worm - jpg.vbs file"; flow:established; content:"filename="; content:".jpg.vbs"; nocase; classtype:misc-activity; sid:797; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Worm -  gif.vbs file"; flow:established; content:"filename="; content:".gif.vbs"; nocase; classtype:misc-activity; sid:798; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Timofonica Worm"; flow:established; content:"filename=|22|TIMOFONICA.TXT.vbs|22|"; nocase; reference:mcafee,98674; classtype:misc-activity; sid:799; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Resume Worm"; flow:established; content:"filename=|22|NORMAL.DOT|22|"; nocase; reference:mcafee,98661; classtype:misc-activity; sid:800; rev:9;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible Worm - doc.vbs file"; flow:established; content:"filename="; content:".doc.vbs"; nocase; classtype:misc-activity; sid:801; rev:7;)
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possible NewApt.Worm - farter.exe"; flow:established; content:"filename=|22|FARTER.EXE|22|"; nocase; reference:mcafee,1054; classtype:misc-activity; sid:789; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED VIRUS Klez Incoming"; flow:to_server,established; dsize:>120; content:"MIME"; content:"VGhpcyBwcm9"; classtype:misc-activity; sid:1800; rev:6;)
# pcre makes this not needed
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"DELETED SMTP XEXCH50 overflow with evasion attempt"; flow:to_server,established; content:"XEXCH50"; nocase; content:"-0"; distance:1; reference:url,www.microsoft.com/technet/security/bulletin/MS03-046.mspx; classtype:attempted-admin; sid:2254; rev:4;)

# historical reference... this used to be here...
# alert tcp any 110 -> any any (msg:"DELETED Virus - Possbile Zipped Files Trojan"; flow:established; content:"name =|22|Zipped_Files.EXE|22|"; reference:mcafee,10450; classtype:misc-activity; sid:802; rev:9;)

# taken care of by http_inspect now
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS multiple decode attempt"; flow:to_server,established; uricontent:"%5c"; uricontent:".."; reference:bugtraq,2708; reference:cve,2001-0333; reference:nessus,10671; classtype:web-application-attack; sid:970; rev:13;)

# better rule for 1054 caused these rules to not be needed
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC Tomcat sourecode view"; flow:to_server,established; uricontent:".js%2570"; nocase; classtype:attempted-recon; sid:1236; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC Tomcat sourecode view"; flow:to_server,established; uricontent:".j%2573p"; nocase; classtype:attempted-recon; sid:1237; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC Tomcat sourecode view"; flow:to_server,established; uricontent:".%256Asp"; nocase; classtype:attempted-recon; sid:1238; rev:7;)

# these rules are dumb.  sid:857 looks for the access, and thats all we can do
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI faxsurvey attempt full path"; flow:to_server,established; uricontent:"/faxsurvey?/"; nocase; reference:bugtraq,2056; reference:cve,1999-0262; reference:nessus,10067; classtype:web-application-attack; sid:1647; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-CGI faxsurvey arbitrary file read attempt"; flow:to_server,established; uricontent:"/faxsurvey?cat%20"; nocase; reference:bugtraq,2056; reference:cve,1999-0262; reference:nessus,10067; classtype:web-application-attack; sid:1609; rev:8;)

# dup of 2061
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC Tomcat directory traversal attempt"; flow:to_server,established; uricontent:"|00|.jsp"; reference:bugtraq,2518; classtype:web-application-attack; sid:1055; rev:10;)



# squash all of the virus rules into one rule.  go PCRE!
# alert tcp any any -> any 139 (msg:"DELETED Virus - Possible QAZ Worm Infection"; flow:established; content:"qazwsx.hsq"; reference:mcafee,98775; classtype:misc-activity; sid:732; rev:10;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .shs file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".shs|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:730; rev:8;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .exe file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".exe|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2160; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .doc file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".doc|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2161; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .vbs file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".vbs|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:793; rev:8;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .hta file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".hta|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2162; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .chm file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".chm|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2163; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .reg file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".reg|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2164; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .ini file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".ini|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2165; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .bat file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".bat|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2166; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .diz file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".diz|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2167; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .cpp file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".cpp|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2168; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .dll file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".dll|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2169; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .vxd file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".vxd|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2170; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .sys file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".sys|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2171; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .com file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".com|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2172; rev:5;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .scr file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".scr|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:729; rev:8;)
# alert tcp $SMTP_SERVERS any -> $EXTERNAL_NET 25 (msg:"DELETED VIRUS OUTBOUND .hsq file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:"filename=|22|"; within:30; content:".hsq|22|"; within:30; nocase; classtype:suspicious-filename-detect; sid:2173; rev:5;)

# uh, yeah this happens quite a bit.
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC ?open access"; flow:to_server,established; uricontent:"?open"; nocase; classtype:web-application-activity; sid:1561; rev:6;)

# dup of 1485
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC mkilog.exe access"; flow:to_server,established; uricontent:"/mkilog.exe"; nocase; classtype:web-application-activity; sid:1665; rev:7;)

# dup of 2339
# alert udp $EXTERNAL_NET any -> $HOME_NET 69 (msg:"DELETED TFTP NULL command attempt"; content:"|00 00|"; depth:2; reference:bugtraq,7575; classtype:bad-unknown; sid:2336; rev:4;)

# these happen.  more research = more better rules
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"DELETED SMTP SSLv3 invalid timestamp attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; byte_test:4,>,2147483647,5,relative; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2503; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"DELETED WEB-MISC SSLv3 invalid timestamp attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; byte_test:4,>,2147483647,5,relative; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2506; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 636 (msg:"DELETED MISC LDAP SSLv3 invalid timestamp attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; byte_test:4,>,2147483647,5,relative; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2499; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 993 (msg:"DELETED IMAP SSLv3 invalid timestamp attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; byte_test:4,>,2147483647,5,relative; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2498; rev:10;)


#nmap is no longer as dumb as it once was...
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED SCAN nmap TCP"; flow:stateless; ack:0; flags:A,12; reference:arachnids,28; classtype:attempted-recon; sid:628; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED SCAN nmap fingerprint attempt"; flow:stateless; flags:SFPU; reference:arachnids,05; classtype:attempted-recon; sid:629; rev:8;)

# dup of 553
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED POLICY FTP anonymous ftp login attempt"; flow:to_server,established; content:"USER"; nocase; content:" ftp|0D 0A|"; nocase; classtype:misc-activity; sid:1449; rev:8;)

# dup of 2417, which is a better rule anyways
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP format string attempt"; flow:to_server,established; content:"%p"; nocase; reference:bugtraq,1387; reference:bugtraq,2240; reference:bugtraq,726; reference:cve,1999-0997; reference:cve,2000-0573; reference:nessus,10452; classtype:attempted-admin; sid:1530; rev:14;)

# ans1 goodness takes care of this one for us
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"DELETED NETBIOS SMB-DS DCERPC NTLMSSP invalid mechlistMIC attempt"; flow:to_server,established; content:"|FF|SMBs"; depth:5; offset:4; nocase; content:"`"; depth:1; offset:63; content:"|00 00 00|b|06 83 00 00 06|+|06 01 05 05 02|"; within:15; distance:1; content:"|06 0A|+|06 01 04 01 82|7|02 02 0A|"; distance:0; content:"|A3|>0<|A0|0"; distance:0; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12054; reference:nessus,12065; classtype:attempted-dos; sid:2385; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"DELETED NETBIOS SMB NTLMSSP invalid mechlistMIC attempt"; flow:to_server,established; content:"|FF|SMBs"; depth:5; offset:4; nocase; content:"`"; depth:1; offset:63; content:"|00 00 00|b|06 83 00 00 06|+|06 01 05 05 02|"; within:15; distance:1; content:"|06 0A|+|06 01 04 01 82|7|02 02 0A|"; distance:0; content:"|A3|>0<|A0|0"; distance:0; reference:bugtraq,9633; reference:bugtraq,9635; reference:cve,2003-0818; reference:nessus,12052; reference:nessus,12054; reference:nessus,12065; classtype:attempted-dos; sid:2384; rev:12;)


# because this rule sucks
# alert tcp $HOME_NET 7161 -> $EXTERNAL_NET any (msg:"DELETED MISC Cisco Catalyst Remote Access"; flow:stateless; flags:SA,12; reference:arachnids,129; reference:bugtraq,705; reference:cve,1999-0430; classtype:bad-unknown; sid:513; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"DELETED SCAN Proxy Port 8080 attempt"; flow:stateless; flags:S,12; classtype:attempted-recon; sid:620; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1080 (msg:"DELETED SCAN SOCKS Proxy attempt"; flow:stateless; flags:S,12; reference:url,help.undernet.org/proxyscan/; classtype:attempted-recon; sid:615; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3128 (msg:"DELETED SCAN Squid Proxy attempt"; flow:stateless; flags:S,12; classtype:attempted-recon; sid:618; rev:11;)


# http inspect does a better job than these rules do
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS unicode directory traversal attempt"; flow:to_server,established; content:"/..%c0%af../"; nocase; reference:bugtraq,1806; reference:cve,2000-0884; reference:nessus,10537; classtype:web-application-attack; sid:981; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS unicode directory traversal attempt"; flow:to_server,established; content:"/..%c1%1c../"; nocase; reference:bugtraq,1806; reference:cve,2000-0884; reference:nessus,10537; classtype:web-application-attack; sid:982; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS unicode directory traversal attempt"; flow:to_server,established; content:"/..%c1%9c../"; nocase; reference:bugtraq,1806; reference:cve,2000-0884; reference:nessus,10537; classtype:web-application-attack; sid:983; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-IIS unicode directory traversal attempt"; flow:to_server,established; content:"/..%255c.."; nocase; reference:bugtraq,1806; reference:cve,2000-0884; reference:nessus,10537; classtype:web-application-attack; sid:1945; rev:8;)

# dup of 1672
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP CWD ~<CR><NEWLINE> attempt"; flow:to_server,established; content:"CWD "; content:" ~|0D 0A|"; reference:bugtraq,2601; reference:cve,2001-0421; classtype:denial-of-service; sid:1728; rev:8;)

# dup of 1229
# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"DELETED FTP CWD .... attempt"; flow:to_server,established; content:"CWD "; content:" ...."; reference:bugtraq,4884; classtype:denial-of-service; sid:1779; rev:4;)

# dup of 1757
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC b2 access"; flow:to_server,established; uricontent:"/b2/b2-include/"; content:"b2inc"; content:"http|3A|//"; reference:bugtraq,4673; reference:cve,2002-0734; reference:cve,2002-1466; reference:nessus,11667; classtype:web-application-attack; sid:1758; rev:9;)

# dup of 653
# alert ip $EXTERNAL_NET $SHELLCODE_PORTS -> $HOME_NET any (msg:"DELETED SHELLCODE x86 0x90 NOOP unicode"; content:"|90 00 90 00 90 00 90 00 90 00 90 00 90 00 90 00|"; classtype:shellcode-detect; sid:2314; rev:3;)

# converted to a dup by 1437 moving to regex
# alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"DELETED MULTIMEDIA Windows Media Video download"; flow:from_server,established; content:"Content-type|3A| video/x-ms-asf"; nocase; content:"|0A|"; within:2; classtype:policy-violation; sid:1438; rev:8;)

# handled by 1212
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"DELETED WEB-MISC order.log access"; flow:to_server,established; uricontent:"/admin_files/order.log"; nocase; classtype:attempted-recon; sid:1176; rev:7;)

# alert tcp $EXTERNAL_NET any -> $HOME_NET 995 (msg:"DELETED POP3 SSLv3 invalid timestamp attempt"; flow:to_server,established; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; byte_test:4,>,2147483647,5,relative; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2501; rev:12;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR netbus 1.7 runtime detection - initial connection"; flow:from_server,established; content:"NetBus"; depth:6; nocase; pcre:"/^NetBus\s+\d+\x2E\d+/smi"; reference:url,www.2-spyware.com/file-backdoor-netbus-12-exe.html; classtype:trojan-activity; sid:6038; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED BACKDOOR optixlite 1.0 runtime detection - conn failure-cts"; flow:to_server,established; content:"password|3B|"; depth:9; nocase; flowbits:set, optixlite_fai_conn_cts; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=1577; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=26952; classtype:trojan-activity; sid:6067; rev:2;)
alert tcp $HOME_NET 666 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR satanz Backdoor runtime detection"; flow:from_server,established; content:"INIRemote|3A| "; depth:11; nocase; content:"You are connected to me.|0D 0A|Remote|3A| Ready for commands"; distance:0; nocase; reference:url,www.megasecurity.org/trojans/s/satanzbackdoor/SBD2.0b.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=5260; classtype:trojan-activity; sid:6158; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED BACKDOOR clindestine 1.0 icq notification of server installation"; flow:to_server,established; uricontent:"/scripts/WWPMsg.dll"; nocase; content:"Host|3A|"; nocase; content:"wwp.mirabilis.com"; distance:0; nocase; content:"from="; nocase; content:"fromemail="; distance:0; nocase; content:"subject="; distance:0; nocase; content:"to=24962844"; distance:0; nocase; pcre:"/^Host\x3a[^\r\n]*wwp\.mirabilis\.com.*from=[^\r\n]*fromemail=[^\r\n]*subject=[^\r\n]*to=24962844/smi"; reference:url,www.spywareguide.com/product_show.php?id=1486; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=1295; classtype:trojan-activity; sid:6135; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR netsphere v1.31.337 final runtime detection"; flow:from_server,established; content:"<NetSphere|7C|v1.31.337 FINAL|7C|0>"; depth:29; nocase; reference:url,www.megasecurity.org/trojans/n/netsphere/NetSphere1.31.337final.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=31847; classtype:trojan-activity; sid:6162; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"DELETED BACKDOOR fkwp 2.0 runtime detection - conn success-cts"; flow:to_server,established; content:"AUTH"; depth:4; nocase; flowbits:set,fkwp_conn_suc_cts; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=815; classtype:trojan-activity; sid:6032; rev:2;)
alert tcp $HOME_NET 6969 -> $EXTERNAL_NET any (msg:"DELETED BACKDOOR gate crahser v1.2 runtime detection"; flow:from_server,established; content:"GateCrasher"; depth:11; nocase; content:"Server"; distance:0; nocase; content:"On-Line..."; distance:0; nocase; pcre:"/^GateCrasher\s+v\d+\x2E\d+\x2C\s+Server\s+On-Line\x2E\x2E\x2E/smi"; reference:url,www.spywareguide.com/product_show.php?id=973; classtype:trojan-activity; sid:6163; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Trickler VX2/ABetterInternet transponder thinstaller runtime detection - download request 2"; flow:to_server,established; uricontent:"/a/Aid.sen?StubName="; nocase; reference:url,research.sunbelt-software.com/threat_display.cfm?name=ABetterInternet&threatid=14797; reference:url,www.doxdesk.com/parasite/Transponder.html; classtype:misc-activity; sid:5870; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Trickler VX2/ABetterInternet transponder thinstaller runtime detection - download request 1"; flow:to_server,established; uricontent:"/a/Drk.syn?bho="; nocase; reference:url,research.sunbelt-software.com/threat_display.cfm?name=ABetterInternet&threatid=14797; reference:url,www.doxdesk.com/parasite/Transponder.html; classtype:misc-activity; sid:5869; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware deskwizz runtime detection - ad banner"; flow:to_server,established; uricontent:"/GetAd/DolRevWrld"; nocase; pcre:"/GetAd\x2FDolRevWrld(Top|Bottom)\x2Etxt/Ui"; content:"Host|3A|"; nocase; content:"deskwizz.com"; distance:0; nocase; pcre:"/^Host\x3A[^\r\n]*deskwizz\x2Ecom/smi"; reference:url,www.spywareguide.com/product_show.php?id=1127; classtype:misc-activity; sid:6210; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker zeropopup runtime detection - button search"; flow:to_server,established; uricontent:"/searchbar/search.php"; nocase; uricontent:"term="; nocase; content:"Host|3A|"; nocase; content:"www.znext.com"; distance:0; nocase; reference:url,www.spywareguide.com/product_show.php?id=627; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453075510; classtype:misc-activity; sid:6393; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware bundleware ds3 runtime detection - initial connection"; flow:to_server,established; uricontent:"/cgi-bin/InitV2"; nocase; uricontent:"ID="; nocase; uricontent:"type="; nocase; uricontent:"mSkip="; nocase; uricontent:"rnd="; nocase; content:"Host|3A|"; nocase; content:"www.ad-w-a-r-e.com"; nocase; pcre:"/^Host\x3a[^\r\n]*www\x2Ead-w-a-r-e\x2Ecom/smi"; reference:url,www.nuker.com/container/details/bundleware.php; classtype:misc-activity; sid:6272; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware spoton runtime detection"; flow:to_server,established; uricontent:"/js/jsnew2.php?"; nocase; uricontent:"grp="; nocase; uricontent:"guid="; nocase; uricontent:"ft_id="; nocase; uricontent:"c="; nocase; uricontent:"ver="; nocase; content:"k="; nocase; reference:url,www.spywareguide.com/product_show.php?id=505; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453073158; classtype:misc-activity; sid:6235; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware bundleware ds3 runtime detection - pop-up retreival"; flow:to_server,established; uricontent:"/cgi-bin/PopupV3"; nocase; uricontent:"ID="; nocase; uricontent:"type="; nocase; uricontent:"mSkip="; nocase; uricontent:"rnd="; nocase; content:"Host|3A|"; nocase; content:"www.ad-w-a-r-e.com"; nocase; pcre:"/^Host\x3a[^\r\n]*www\x2Ead-w-a-r-e\x2Ecom/smi"; reference:url,www.nuker.com/container/details/bundleware.php; classtype:misc-activity; sid:6273; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker gigatech superbar runtime detection - hijack ie auto search"; flow:to_server,established; uricontent:"/bin/findwhat.dll?getresults"; nocase; content:"base="; nocase; content:"dc="; nocase; content:"aff_id="; nocase; content:"mt="; nocase; content:"ip_addr="; nocase; reference:url,www.spywareguide.com/product_show.php?id=500; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453075466; classtype:misc-activity; sid:6262; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware exact.bargainbuddy runtime detection - adp ads"; flow:to_server,established; uricontent:"/exact/rotate/"; nocase; content:"Host|3A|"; nocase; content:"offers.bullseye-network.com"; distance:0; nocase; pcre:"/^Host\x3A[^\r\n]*offers\x2Ebullseye-network\x2Ecom/smi"; threshold:type limit, track by_src, count 1, seconds 600; reference:url,www.spywareguide.com/product_show.php?id=463; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453068324; classtype:misc-activity; sid:6229; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware flashtrack media runtime detection - download .dll"; flow:to_server,established; uricontent:"/upgradexmod.dll?"; nocase; uricontent:"c="; nocase; uricontent:"g="; nocase; uricontent:"i="; nocase; uricontent:"ver="; nocase; content:"User-Agent|3A|"; nocase; content:"Daemon"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]*Daemon/smi"; reference:url,www.spywareguide.com/product_show.php?id=477; classtype:misc-activity; sid:6369; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker navexcel runtime detection"; flow:to_server,established; uricontent:"/search?"; nocase; uricontent:"p="; nocase; uricontent:"ts="; nocase; uricontent:"w="; nocase; reference:url,www.spywareguide.com/product_show.php?id=607; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453074928; classtype:misc-activity; sid:6277; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware flashtrack media runtime detection - download .exe"; flow:to_server,established; uricontent:"/apps/ft30s.exe?"; nocase; uricontent:"c="; nocase; uricontent:"g="; nocase; uricontent:"i="; nocase; content:"User-Agent|3A|"; nocase; content:"Daemon"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]*Daemon/smi"; reference:url,www.spywareguide.com/product_show.php?id=477; classtype:misc-activity; sid:6370; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware mirar runtime detection - search"; flow:to_server,established; uricontent:"/?KEYWORD="; nocase; uricontent:"T="; nocase; uricontent:"ERROR="; content:"Host|3A|"; nocase; content:"websearch.getmirar.com"; distance:0; nocase; pcre:"/^Host\x3A[^\r\n]*websearch\x2Egetmirar\x2Ecom/smi"; reference:url,www.spywareguide.com/product_show.php?id=637; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453078818; classtype:misc-activity; sid:6231; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"DELETED WEB-CLIENT DXImageTransform.Microsoft.Light ActiveX function call access"; flow:established,to_client; content:"DXImageTransform.Microsoft.Light"; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DXImageTransform.Microsoft.Light\x22|\x27DXImageTransform.Microsoft.Light\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DXImageTransform.Microsoft.Light\x22|\x27DXImageTransform.Microsoft.Light\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; reference:cve,2006-2383; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6519; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker wowok mp3 bar runtime detection - tracking"; flow:to_server,established; uricontent:"t.php"; nocase; uricontent:"sc_project="; nocase; uricontent:"resolution="; nocase; uricontent:"camefrom="; nocase; uricontent:"camefrom="; nocase; uricontent:"u="; nocase; uricontent:"java="; nocase; uricontent:"security="; nocase; uricontent:"sc_random="; nocase; pcre:"/u=[^\r\n]*www.wowokay.com/Ui"; reference:url,www.zdnet.com.au/downloads/0,39024478,39111669s,00.htm; classtype:misc-activity; sid:7131; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker wowok mp3 bar runtime detection - search assissant hijacking"; flow:to_server,established; uricontent:"/?s="; nocase; content:"Host|3A|"; nocase; content:"www.weepee.com"; distance:0; nocase; pcre:"/^Host\x3A[^\r\n]*www\x2Eweepee\x2Ecom/smi"; reference:url,www.zdnet.com.au/downloads/0,39024478,39111669s,00.htm; classtype:misc-activity; sid:7134; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker wowok mp3 bar runtime detection - advertising 1"; flow:to_server,established; uricontent:"/mb/text_group.php"; nocase; uricontent:"sid="; nocase; uricontent:"col="; nocase; uricontent:"br="; nocase; uricontent:"dk="; nocase; content:"Referer|3A|"; nocase; content:"www.wowokay.com/wowokaybar.php"; distance:0; nocase; pcre:"/^Referer\x3A[^\r\n]*www\x2Ewowokay\x2Ecom/wowokaybar\x2Ephp/smi"; reference:url,www.zdnet.com.au/downloads/0,39024478,39111669s,00.htm; classtype:misc-activity; sid:7132; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker wowok mp3 bar runtime detection - advertising 2"; flow:to_server,established; uricontent:"/ea.exe"; nocase; uricontent:"sb"; nocase; uricontent:"joelesoftware"; nocase; uricontent:"01"; nocase; content:"Referer|3A|"; nocase; content:"www.wowokay.com/wowokaybar.php"; distance:0; nocase; pcre:"/^Referer\x3A[^\r\n]*www\x2Ewowokay\x2Ecom/wowokaybar\x2Ephp/smi"; reference:url,www.zdnet.com.au/downloads/0,39024478,39111669s,00.htm; classtype:misc-activity; sid:7133; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"DELETED SPYWARE-PUT Keylogger desktop detective 2000 runtime detection - info request"; flow:from_server,established; flowbits:isset,DesktopDetective_InfoRequest; content:"|FE FE FE FE|90|00 00|"; depth:8; threshold:type limit, track by_src, count 1, seconds 300; reference:url,www.spywareguide.com/product_show.php?id=349; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453060318; classtype:successful-recon-limited; sid:7182; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 868 (msg:"DELETED SPYWARE-PUT Keylogger ab system spy runtime detection - info update"; flow:to_server,established; flowbits:isset,ABSystemSpy_InfoUpdated; content:"chkCtr"; threshold:type limit, track by_src, count 1, seconds 300; reference:url,www.spywareguide.com/product_show.php?id=591; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453076050; classtype:successful-recon-limited; sid:7174; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 868 (msg:"DELETED SPYWARE-PUT Keylogger ab system spy runtime detection - info update"; flow:to_server,established; flowbits:isset,ABSystemSpy_InfoUpdatec; content:"chkCap"; flowbits:set,ABSystemSpy_InfoUpdated; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7173; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"DELETED SPYWARE-PUT Keylogger desktop detective 2000 runtime detection - info request"; flow:to_server,established; content:"|FE FE FE FE 00 00 00 00|"; depth:8; flowbits:set,DesktopDetective_InfoRequest; flowbits:noalert; classtype:successful-recon-limited; sid:7181; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 868 (msg:"DELETED SPYWARE-PUT Keylogger ab system spy runtime detection - info update"; flow:to_server,established; content:"chkLis"; depth:6; flowbits:set,ABSystemSpy_InfoUpdatea; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7170; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 868 (msg:"DELETED SPYWARE-PUT Keylogger ab system spy runtime detection - info update"; flow:to_server,established; flowbits:isset,ABSystemSpy_InfoUpdateb; content:"chkCli"; flowbits:set,ABSystemSpy_InfoUpdatec; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7172; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 868 (msg:"DELETED SPYWARE-PUT Keylogger ab system spy runtime detection - info update"; flow:to_server,established; flowbits:isset,ABSystemSpy_InfoUpdatea; content:"chkShe"; flowbits:set,ABSystemSpy_InfoUpdateb; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7171; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker funbuddyicons runtime detection - funwebproducts user-agent string"; flow:to_server,established; content:"User-Agent|3A|"; nocase; content:"FunWebProducts"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]*FunWebProducts/smi"; threshold:type limit, track by_src, count 1, seconds 300; reference:url,www.pchell.com/support/funbuddyicons.shtml; classtype:misc-activity; sid:5856; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Hijacker webcrawler runtime detection"; flow:to_server,established; uricontent:"/info.wbcrwl.toolbar/tbar/plugin/"; nocase; content:"User-Agent|3A|"; nocase; content:"Infospace"; distance:0; nocase; content:"Toolbar"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]*Infospace\s+Toolbar/smi"; threshold:type limit, track by_src, count 1, seconds 3000; reference:url,www.spywareguide.com/product_show.php?id=2134; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453079952; classtype:misc-activity; sid:5912; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED SPYWARE-PUT Adware hxdl runtime detection - crypt user-agent"; flow:to_server,established; content:"User-Agent|3A|"; nocase; content:"CryptRetrieveObjectByUrl|3A 3A|InetSchemeProvider"; distance:0; nocase; pcre:"/^User-Agent\x3A[^\r\n]+CryptRetrieveObjectByUrl\x3A\x3AInetSchemeProvider/smi"; reference:url,www.spywareguide.com/product_show.php?id=516; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453075079; classtype:misc-activity; sid:7555; rev:2;)
